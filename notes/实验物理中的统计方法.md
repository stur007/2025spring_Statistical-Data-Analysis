# å®éªŒç‰©ç†ä¸­çš„ç»Ÿè®¡æ–¹æ³•

## chap 01 åŸºæœ¬æ¦‚å¿µ

1. éšæœºäº‹ä»¶ï¼šç°è±¡$A$æœ‰å¯èƒ½å‘ç”Ÿï¼Œä¹Ÿæœ‰å¯èƒ½ä¸å‘ç”Ÿï¼Œé‚£ä¹ˆç°è±¡$A$å‘ç”Ÿçš„äº‹ä¾‹å«åšéšæœºäº‹ä»¶ã€‚

2. æ¦‚ç‡

   æŸ¯å°”è«æˆˆå¤«å…¬ç†ï¼šï¼ˆæ¦‚ç‡çš„å®šä¹‰ï¼‰æ¦‚ç‡æ˜¯äº‹ä»¶çš„å‡½æ•°ã€‚

   - $P(A)\geq0$
   - $P(S)=1$
   - è‹¥$A\cap B=\varnothing$ï¼Œåˆ™$P(A)+P(B)=P(A\cup B)$

3. æ¡ä»¶æ¦‚ç‡ä¸ç‹¬ç«‹æ€§

   $P(A|B)=\frac{P(AB)}{P(B)}$

   $A$ä¸$B$ç‹¬ç«‹ï¼š$P(A|B)=P(A)$

   > $A\cap B=\varnothing$ ä¸èƒ½æ¨å‡º ABç‹¬ç«‹æ— å…³ã€‚

4. æ¦‚ç‡çš„è¯ é‡Š

   - æ¦‚ç‡æ˜¯ç›¸å¯¹é¢‘ç‡ï¼ˆ**å¯é‡å¤**å®éªŒä¸­æŸä¸ªç»“æœå‡ºç°çš„æ¬¡æ•°å æ‰€æœ‰ç»“æœçš„æ¯”ä¾‹ï¼‰

   - **ä¸»è§‚**æ¦‚ç‡ï¼ˆè´å¶æ–¯æ¦‚ç‡ï¼‰

     **$P(A)=å¯¹Aä¸ºçœŸçš„ä¿¡å¿ƒç¨‹åº¦$**

5. è´å¶æ–¯å®šç†ä¸å…¨æ¦‚ç‡å…¬å¼
   $$
   P(A|B)=\frac{P(B|A)\cdot P(A)}{P(B)}
   $$

   $$
   P(B)=P(\cup_i(B\cap A_i))=\sum_i P(B\cap A_i)=\sum_iP(B|A_i)P(A_i)
   $$

   > é˜é‡Šï¼š
   >
   > -  $P(A)$ä¸ºç†è®ºçš„**å…ˆéªŒæ¦‚ç‡**ï¼šâ€œæŠ›æ·ä¸€æšç¡¬å¸ï¼Œæ­£é¢åé¢å‘ä¸Šçš„å¯èƒ½æ€§å„å ä¸€åŠâ€è¿™ä¸€ç†è®ºæ­£ç¡®çš„æ¦‚ç‡
   > -  $P(B|A)$ä¸ºç†è®ºé¢„è¨€çš„å®éªŒæ­£ç¡®çš„æ¦‚ç‡ï¼šâ€œç¡¬å¸æ­£é¢å‘ä¸Šçš„æ¦‚ç‡ä¸º$\frac{1}{2}$â€
   > -  $P(A|B)$ä¸ºç†è®ºçš„**åéªŒæ¦‚ç‡**
   >
   > å°†$P(A|B)$ä½œä¸ºä¸‹ä¸€æ¬¡çš„å…ˆéªŒæ¦‚ç‡ï¼Œè¿›è¡Œä¸æ–­è¿­ä»£ã€‚
   >
   > ä¾‹å­ï¼šä¸‰é—¨é—®é¢˜
   >
   > ![image-20250227174035630](https://raw.githubusercontent.com/stur007/img/main/img/202502271742784.png)
   >
   > ![image-20250227174051460](https://raw.githubusercontent.com/stur007/img/main/img/202502271740096.png)
   >
   > ![image-20250227174112483](https://raw.githubusercontent.com/stur007/img/main/img/202502271741787.png)

6. éšæœºå˜é‡ä¸æ¦‚ç‡å¯†åº¦å‡½æ•°ã€ç´¯ç§¯åˆ†å¸ƒå‡½æ•°

   æ¦‚ç‡å¯†åº¦å‡½æ•° (p.d.f.)

   ç´¯ç§¯åˆ†å¸ƒå‡½æ•° (c.d.f.)

7. $\alpha$åˆ†ä½æ•°ã€ä¸­ä½æ•°ã€ä¼—æ•°

   å®šä¹‰ï¼š
   $$
   F(x_\alpha)=\alpha
   $$
   æŒ‰ç…§æ•°å€¼å°çš„ä¸€æ–¹é¢ç§¯åˆ†å®šä¹‰ã€‚

   å³ï¼Œ$\alpha$-åˆ†ä½æ•°ç§°ä¸ºä¸‹ä¾§$\alpha$-åˆ†ä½æ•°ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å¯¹åº”çš„å®šä¹‰ä¸Šä¾§$\alpha$-åˆ†ä½æ•°ã€‚

8. ç›´æ–¹å›¾ä¸æ¦‚ç‡å¯†åº¦å‡½æ•°

   è”åˆæ¦‚ç‡å¯†åº¦åˆ†å¸ƒå‡½æ•°$f(x,y)$

   è¾¹ç¼˜æ¦‚ç‡å¯†åº¦$f_x(x), f_y(y)$

   ç›¸äº’ç‹¬ç«‹ï¼š
   $$
   f(x, y) = f_x(x)f_y(y)
   $$

9. éšæœºå˜é‡çš„å‡½æ•°

   - ä¸€ç»´éšæœºå˜é‡

   å‡½æ•° $a=a(x)$ï¼Œ$x$çš„æ¦‚ç‡å¯†åº¦å‡½æ•°$f(x)\mathrm{d}x$
   $$
   g(a)\mathrm{d}a=f(x)\mathrm{d}x
   $$
   å¾—åˆ°ï¼š
   $$
   g(a)=f(x)\left|\frac{\mathrm{d}x(a)}{\mathrm{d}{a}}\right|
   $$

   - å¤šç»´éšæœºå˜é‡çš„å‡½æ•°

     å¦‚ï¼š$z=xy$

     Mellin å·ç§¯
     $$
     f(z)=\int_{-\infty}^\infty g(x)h(\frac{z}{x})\frac{\mathrm{d}x}{|x|}
     $$
     Flourier å·ç§¯
     $$
     f(z)\int_{-\infty}^{\infty}g(x)h(z-x)\mathrm{d}x
     $$

   - Jacobi è¡Œåˆ—å¼

     åšå˜æ¢ï¼Œå°†æˆ‘ä»¬ä¸å…³å¿ƒçš„å‡½æ•°éƒ¨åˆ†ç§¯åˆ†æ‰ï¼Œå¾—åˆ°æˆ‘ä»¬å…³å¿ƒçš„æ¦‚ç‡ã€‚

10. æœŸå¾…å€¼ä¸æ–¹å·®

    æœŸå¾…å€¼ã€æ–¹å·®ã€æ ‡å‡†å·®

    - æœŸå¾…å€¼

    $$
    \mu = E[x]=\int xf(x)\mathrm{d}x
    $$
    - åæ–¹å·®

    $$
    \text{cov}[x, y] = E[(x-\mu_x)(y-\mu_y)]=E[xy]-\mu_x\mu_y
    $$
    - (Pearson)ç›¸å…³ç³»æ•°

    $$
    \rho_{x,y}=\frac{\text{cov}[x, y]}{\sigma_x\sigma_y}
    $$

    - åæ–¹å·®çŸ©é˜µ$V$ï¼š

    $$
    V_{ij}=\text{cov}[x_i, x_j]
    $$

    ç”±å®šä¹‰ï¼Œåæ–¹å·®çŸ©é˜µä¸ºå¯¹ç§°çŸ©é˜µã€‚

    >  ç›¸å…³æ€§å®šä¹‰çš„å±€é™æ€§ï¼šç›¸å…³ç³»æ•°ä¸º0ï¼Œä½†æ˜¯ä¸èƒ½è¯´æ˜xä¸yä¸ç›¸å…³ã€‚
    >
    >  å…¶ä»–çš„æ¯”è¾ƒæ–¹å¼ï¼šç§©ç›¸å…³æ€§ï¼ˆåªçœ‹é¡ºåºï¼Œä¸çœ‹æ•°å€¼ï¼‰ç­‰ç­‰
    >
    >  ![](https://raw.githubusercontent.com/stur007/img/main/img/202503061653002.png)

    > åŸç‚¹çŸ©ä¸ä¸­å¿ƒçŸ©
    > $$
    > \mu_k = E(X^k)
    > $$
    >
    > $$
    > \nu_k=E[(X-E(X))^k]
    > $$

    > å…¶ä»–ç‰¹å¾æ•°ï¼š
    >
    > ååº¦ç³»æ•°
    >
    > ![image-20250306170330021](https://raw.githubusercontent.com/stur007/img/main/img/202503061703410.png)

    

11. ç‰¹å¾å‡½æ•°

    å¯¹äºéšæœºå˜é‡$X$ï¼Œç§°$\mathrm{e}^{\mathrm{i}tX}$çš„æ•°å­¦æœŸæœ›å€¼ä¸ºéšæœºå˜é‡çš„ç‰¹å¾å‡½æ•°ã€‚
    $$
    \varphi(t)=E[\mathrm{e}^{\mathrm{i}tX}]
    $$
    å¯¹äºè¿ç»­çš„æƒ…å†µï¼Œ
    $$
    \varphi(t)=\int_{-\infty}^{\infty}\mathrm{e}^{\mathrm{i}tX}f(x)\mathrm{d}x
    $$
    ç‰¹å¾å‡½æ•°çš„æ€§è´¨ï¼š

    å¦‚æœ$X$$Y$ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™ç‰¹å¾å‡½æ•°
    $$
    \varphi_{X+Y}(t)=E[\mathrm{e}^{\mathrm{i}t(X+Y)}]=E[\mathrm{e}^{\mathrm{i}tX}\mathrm{e}^{\mathrm{i}tY}]=\varphi_X(t)\varphi_Y(t)
    $$

    > ä¸€ä¾‹ï¼š
    >
    > å·²çŸ¥éšæœºå˜é‡$X_1, ... , X_n$æœä»ç›¸åŒçš„æ¦‚ç‡åˆ†å¸ƒ$f(x)$ä¸”ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™å¦‚ä½•è®¡ç®—$X=\Sigma_{i=1}^nX_i$çš„æ¦‚ç‡åˆ†å¸ƒå‡½æ•°ï¼Ÿ
    >
    > è§£ï¼š
    >
    > å°†å·ç§¯è½¬åŒ–ä¸ºä¹˜ç§¯ï¼Œéƒ½åŒ–æˆç‰¹å¾å‡½æ•°å¤„ç†ã€‚ï¼ˆå‚…é‡Œå¶å˜æ¢çš„æ€§è´¨ï¼‰

12. ä¸ç¡®å®šåº¦çš„ä¼ é€’

    é—®é¢˜è¡¨è¿°ï¼š

    å‡è®¾æˆ‘ä»¬å¯¹æŸä¸ªé‡æµ‹é‡äº†ä¸€ç»„å€¼ $\vec x= (x_1,â€¦,x_n)$ï¼Œå¹¶å¾—åˆ°å…¶ åæ–¹å·® $ğ‘‰_{ij}=\text{cov}[x_i,x_j]$ï¼ˆè¡¨å¾ä¸$x_i$æœ‰å…³çš„æµ‹é‡ä¸ç¡®å®šåº¦ï¼‰ã€‚ ä¸ç¡®å®šåº¦çš„ä¼ é€’(1) 73 ç°è€ƒè™‘ä¸€å‡½æ•° $y=y(\vec x)$ ï¼Œå¦‚ä½•æ±‚å…¶æ–¹å·®$V[y]$ï¼Ÿ

    ä¾‹ï¼š

    è€ƒè™‘éšæœºå˜é‡$X_1, X_2$ä¸ä¸ç¡®å®šåº¦$\sigma_1,\sigma_2$ï¼Œè®¡ç®—$Y=f(X_1, X_2)$çš„ä¸ç¡®å®šåº¦ï¼Ÿ
    $$
    \sigma_Y=\sqrt{\left(\frac{\partial f}{\partial X_1}\right)^2\sigma_{X_1}^2+\left(\frac{\partial f}{\partial X_2}\right)^2\sigma_{X_2}^2+2\frac{\partial f}{\partial X_1}\frac{\partial f}{\partial X_2}\text{cov}[X_1, X_2]}
    $$
    **è¯æ˜ï¼š**

    è®¤ä¸ºè¯¯å·®ä¸å¤ªå¤§ï¼Œå°† $Y$åœ¨å¹³å‡å€¼é™„è¿‘å±•å¼€ï¼š
    $$
    y(\vec x)=y(\vec \mu)+\Sigma_{i=1}^n\frac{\partial y}{\partial x_i}(x_i-\mu_i)
    $$
    è®¡ç®—
    $$
    \sigma_y =E[y^2]-E[y]^2
    $$
    å³å¯å¾—åˆ°ç»“æœã€‚

    >  éšæœºå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§å¾€å¾€ä¸åæ ‡é€‰å–æœ‰å…³ï¼Œå¯ä»¥é€šè¿‡æ­£äº¤å˜æ¢æ¶ˆé™¤ç›¸å…³æ€§ã€‚å¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ–¹æ¡ˆå¾—åˆ°ç»“æœï¼š
    >
    > ![image-20250306175300884](https://raw.githubusercontent.com/stur007/img/main/img/202503061753236.png)
    >
    > ç”±äºå®å¯¹ç§°çŸ©é˜µå¯ä»¥æ­£äº¤ç›¸ä¼¼å¯¹è§’åŒ–ï¼Œæ‰€ä»¥ä¸€å®šå¯ä»¥æ‰¾åˆ°å¯¹è§’åŒ–çš„åæ–¹å·®çŸ©é˜µã€‚

## chap 02 å¸¸ç”¨æ¦‚ç‡åˆ†å¸ƒ

### äºŒé¡¹åˆ†å¸ƒ

1. å®šä¹‰

   $N$ æ¬¡**ç‹¬ç«‹**æµ‹é‡(ä¼¯åŠªåˆ©è¯•éªŒ)ï¼Œæ¯æ¬¡**åªæœ‰**æˆåŠŸ(æ¦‚ç‡å§‹ç»ˆä¸º$p$) æˆ–å¤±è´¥(æ¦‚ç‡ä¸º$1-p$)ä¸¤ç§å¯èƒ½ã€‚

   å®šä¹‰éšæœºå˜é‡$n$ä¸ºæˆåŠŸçš„æ¬¡æ•°ï¼Œåˆ™$n$æœä»äºŒé¡¹åˆ†å¸ƒï¼š
   $$
   f(n;N,p)=\frac{N!}{n!(N-n)!}p^n(1-p)^{N-n}
   $$
   è®°ä½œ $B(N, p)$ã€‚

2. å¹³å‡å€¼ä¸æ–¹å·®

   éšæœºå˜é‡$n$çš„å¹³å‡å€¼
   $$
   E[n]=Np
   $$
   æ–¹å·®
   $$
   V[n]=Np(1-p)
   $$

   >ä¾‹ï¼šè®¡ç®—æ¢æµ‹æ•ˆç‡ä¸æ¢æµ‹æ•ˆç‡çš„ä¸ç¡®å®šåº¦ã€‚
   >
   >æ¢æµ‹æ•ˆç‡
   >$$
   >\varepsilon = \frac{N^\prime}{N}
   >$$
   >å‡è®¾æ¢æµ‹åˆ°çš„ç²’å­æ•°éµå¾ªäºŒé¡¹åˆ†å¸ƒï¼Œï¼ˆ$E(N^\prime)=N\varepsilon$ï¼‰
   >
   >åˆ™
   >$$
   >\Delta \varepsilon = \frac{\Delta N}{N}=\frac{\sqrt {N\varepsilon (1-\varepsilon)}}{N}
   >$$

### å¤šé¡¹åˆ†å¸ƒ

- æµ‹é‡çš„ç»“æœä¸æ­¢ä¸€ç§ï¼Œå°†å…¶ä¸­ä¸€ç§è§†ä¸ºæˆåŠŸï¼Œå…¶ä»–è§†ä½œå¤±è´¥ï¼Œåˆ™å˜ä¸ºäºŒé¡¹åˆ†å¸ƒã€‚

### æ³Šæ¾åˆ†å¸ƒ

- æ³Šæ¾åˆ†å¸ƒå¯ä»¥çœ‹ä½œäºŒé¡¹åˆ†å¸ƒçš„æé™è¿‘ä¼¼ï¼Œåœ¨$N\rightarrow \infty, p\rightarrow0,N\rightarrow\nu$çš„æƒ…å†µä¸‹ï¼Œå¾—åˆ°ï¼š

$$
f(n;\nu)=\frac{\nu^n}{n!}\mathrm e^{-\nu}
$$

- å‡å€¼
  $$
  E[n]=\nu
  $$
  æ–¹å·®
  $$
  V[n]=\nu
  $$
  æ³Šæ¾åˆ†å¸ƒçš„ç‰¹ç‚¹ï¼š$n\pm \sqrt n$

- æ³Šæ¾è¿‡ç¨‹â€”â€”æ³Šæ¾åˆ†å¸ƒçš„äº§ç”Ÿ

  æ¡ä»¶ï¼š

  - å•ä½æ—¶é—´äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡å›ºå®š
  - åŒæ—¶å‘ç”Ÿä¸¤æ¬¡äº‹ä»¶å‡ ä¹ä¸å¯èƒ½ï¼ˆæ¯æ¬¡äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ä½ï¼‰
  - æ¯æ¬¡äº‹ä»¶å‘ç”Ÿæ˜¯ç›¸äº’ç‹¬ç«‹çš„

> ä¾‹ï¼š
>
> ![image-20250313161538529](https://raw.githubusercontent.com/stur007/img/main/img/202503131615965.png)
>
> Nè¶Šå¤§ï¼Œpè¶Šå°ï¼Œæ³Šæ¾åˆ†å¸ƒä¸äºŒé¡¹åˆ†å¸ƒè¶Šæ¥è¿‘ï¼
>
> ä¾‹ï¼š
>
> å‡è®¾æŸäººç«™åœ¨è·¯è¾¹æƒ³æ­ä¾¿è½¦ã€‚ 
>
> ï¼ˆ1ï¼‰æ¯åˆ†é’Ÿè¿‡è·¯çš„æ±½è½¦æ•°æœä»æ³Šæ¾åˆ†å¸ƒï¼Œå¹³å‡æ¯åˆ†é’Ÿè¿‡è·¯ä¸€è¾†ï¼Œè®¡ç®—ä¸€å°æ—¶é€šè¿‡çš„æ±½è½¦æ•°çš„åˆ†å¸ƒã€‚
>
> ï¼ˆ2ï¼‰æ¯åˆ†é’Ÿè¿‡è·¯çš„æ±½è½¦æ•°æœä»æ³Šæ¾åˆ†å¸ƒï¼Œå¹³å‡æ¯åˆ†é’Ÿè¿‡è·¯ä¸€è¾†ã€‚å‡è®¾æ¯è¾†è½¦è®©æ­ä¾¿è½¦çš„æ¦‚ç‡ä¸º 1%ï¼Œå¹¶ç›¸äº’ç‹¬ç«‹ã€‚ è®¡ç®—è¿‡äº†60è¾†è½¦åè¿˜æœªèƒ½æ­ä¸Šè½¦çš„æ¦‚ç‡ã€‚
>
> è§£ï¼š
>
> å¯¹äºé—®é¢˜1ï¼Œåˆ†å¸ƒæ˜¾ç„¶æ»¡è¶³æ³Šæ¾åˆ†å¸ƒçš„æ¡ä»¶ï¼ˆæ—¶é—´å¯ä»¥æ— é™ç»†åˆ†ï¼Œæ—¶é—´æ— é™çŸ­çš„æ—¶å€™é€šè¿‡çš„æ±½è½¦æ•°ç›®è¶‹äºé›¶ï¼‰ã€‚
>
> å¯¹äºé—®é¢˜2ï¼Œåˆ†å¸ƒæ»¡è¶³äºŒé¡¹åˆ†å¸ƒçš„æ¡ä»¶ã€‚
>
> ä¾‹ï¼š
>
> ![image-20250313163938120](https://raw.githubusercontent.com/stur007/img/main/img/202503131639561.png)

### å‡åŒ€åˆ†å¸ƒ

1. å‡½æ•°å½¢å¼
   $$
   f(x; \alpha, \beta)=\left \{
   \begin{aligned}
   \frac{1}{\beta -\alpha}, \alpha < x < \beta \\
   0, \mathrm{else}.
   \end{aligned}
   \right.
   $$

2. å‡å€¼ä¸æ–¹å·®
   $$
   E[x]=\frac{\alpha+\beta}{2}
   $$

   $$
   V[x]=\frac{(\beta-\alpha)^2}{12}
   $$

   > å‡åŒ€åˆ†å¸ƒæ˜¯è’™ç‰¹å¡æ´›æ–¹æ³•å®ç°çš„åŸºç¡€ï¼

### æŒ‡æ•°åˆ†å¸ƒ

1. å‡½æ•°å½¢å¼
   $$
   f(x;\xi)=\left \{
   \begin{aligned}
   \frac{1}{\xi}\mathrm{e}^{-x/\xi}, x>0\\
   0, \mathrm{else}
   \end{aligned}
   \right.
   $$

2. æœŸæœ›ä¸æ–¹å·®
   $$
   E[x] =\xi, V[x]=\xi^2
   $$

   > æŒ‡æ•°åˆ†å¸ƒæ²¡æœ‰è®°å¿†æ€§ï¼Œå¯ä»¥ä»»æ„é€‰å–å¼€å§‹ä½ç½®ï¼

### é«˜æ–¯åˆ†å¸ƒ

1. å‡½æ•°å½¢å¼
   $$
   f(x;\mu,\sigma^2)=\frac{1}{\sqrt{2\pi\sigma^2}}\mathrm e^{\frac{-(x-\mu)^2}{2\sigma^2}}
   $$
   ==è®°ä½œ $N(\mu, \sigma^2)$== ã€‚

2. æœŸæœ›å€¼
   $$
   E[x] =\mu
   $$
   æ–¹å·®
   $$
   V[x] =\sigma^2
   $$

   > é«˜æ–¯åˆ†å¸ƒæ˜¯å¯¹è¿ç»­å˜é‡æ¦‚ç‡åˆ†å¸ƒçš„çš„å¾ˆå¥½è¿‘ä¼¼ã€‚
   >
   > ![image-20250313165858705](https://raw.githubusercontent.com/stur007/img/main/img/202503131658172.png)
   >
   > æ³¨æ„ï¼Œå˜é‡$y$çš„åˆ†å¸ƒå½¢å¼ä¸$x$åŸæ¥çš„åˆ†å¸ƒå½¢å¼æ— å…³ã€‚

   > å¤šç»´é«˜æ–¯åˆ†å¸ƒé€šè¿‡åæ–¹å·®çŸ©é˜µå®šä¹‰ï¼š
   > $$
   > f(\vec x; \vec \mu, V)=\frac{1}{(2\pi)^{n/2}|V|^{1/2}}\mathrm e^{[\frac 1 2(\vec x-\vec \mu )^TV^{-1}(\vec x - \vec \mu) ]}
   > $$

   > å¯¹äºäºŒç»´é«˜æ–¯åˆ†å¸ƒå¯ä»¥è¯æ˜

### å¡æ–¹åˆ†å¸ƒ

1. å®šä¹‰

   å¯¹äºç›¸äº’ç‹¬ç«‹çš„é«˜æ–¯éšæœºå˜é‡$x_1, ..., x_n$ï¼Œå®šä¹‰
   $$
   z= \sum_{i=1}^n \frac{(x_i-\mu_i)^2}{\sigma_i^2}
   $$
   å¾—åˆ°$z$æ»¡è¶³çš„åˆ†å¸ƒï¼š
   $$
   f(z;n)=\frac{1}{2^{n/2}\Gamma(n/2)}z^{n/2-1}\mathrm e^{-z/2}
   $$
   è®°ä½œ$\chi^2(n)$

2. å‡å€¼
   $$
   E[z] = n
   $$
   æ–¹å·®
   $$
   V[z]=2n
   $$

   > ä¾‹ï¼šæœ€å°äºŒä¹˜æ³•çš„æ‹Ÿåˆä¼˜åº¦æ£€éªŒ
   > $$
   > y = f(x) = kx+b
   > $$
   > æ”¹å˜$k$ä¸$b$çš„å–å€¼ï¼Œä½¿å¾—
   > $$
   > \chi^2 = \sum_{i=1}^n\frac{(y_i-f(x_i))^2}{\sigma_i^2}
   > $$
   > æå°ã€‚æ­¤æ—¶æˆ‘ä»¬è®¤ä¸ºä¼°è®¡çš„ç»“æœæ˜¯æœ€å¥½çš„ã€‚
   >
   > ä¸æ–­é‡å¤å®éªŒï¼Œå¾—åˆ°ä¸€ç³»åˆ—å¡æ–¹çš„å€¼ï¼Œè¿™ä¸ªå€¼æ»¡è¶³è‡ªç”±åº¦ä¸º==$(n-2)$==çš„å¡æ–¹åˆ†å¸ƒã€‚
   >
   > > æ‹Ÿåˆä¼˜åº¦ï¼š
   > >
   > > På€¼ï¼ˆå‡è®¾æ£€éªŒï¼‰åˆ¤æ–­æœ‰å¤šå¤§çš„æ¦‚ç‡å‡ºé”™ï¼ˆç†è®ºæ¨¡å‹ä¸å®é™…æƒ…å†µæ˜¯å¦å¯ä»¥è®¤ä¸ºç›¸ç¬¦ï¼‰

### æŸ¯è¥¿åˆ†å¸ƒ

![image-20250313174659515](https://raw.githubusercontent.com/stur007/img/main/img/202503131747133.png)

### æœ—é“åˆ†å¸ƒ

![image-20250313174719858](https://raw.githubusercontent.com/stur007/img/main/img/202503131747324.png)

![image-20250313175419153](https://raw.githubusercontent.com/stur007/img/main/img/202503131754676.png)

### è´å¡”åˆ†å¸ƒ

![image-20250313174739409](https://raw.githubusercontent.com/stur007/img/main/img/202503131747918.png)

> $\alpha = \beta = 1$å˜ä¸ºå‡åŒ€åˆ†å¸ƒã€‚

### ä¼½é©¬åˆ†å¸ƒ

![image-20250313174759921](https://raw.githubusercontent.com/stur007/img/main/img/202503131748464.png)

### å­¦ç”Ÿæ°åˆ†å¸ƒ

![image-20250313174812574](https://raw.githubusercontent.com/stur007/img/main/img/202503131748144.png)

## chap 03 è’™ç‰¹å¡ç½—æ–¹æ³• Monte Carlo Method

### æ–¹æ³•ç®€ä»‹

#### åº”ç”¨åœºæ™¯

1. å¯¹äºåˆ†å¸ƒä¸æ–¹ä¾¿è§£ææ±‚è§£ï¼›
2. æ²¡æœ‰å¿…è¦è¿›è¡Œè§£ææ±‚è§£ã€‚
3. å¤„ç†é«˜ç»´æ•°å€¼å®šç§¯åˆ†æ–¹é¢å…·æœ‰ç‹¬ç‰¹çš„ä¼˜åŠ¿ã€‚

#### ä½¿ç”¨æ–¹æ³•

- ä½¿ç”¨MCæ–¹æ³•è®¡ç®—å®šç§¯åˆ†ï¼š
  1. ç”Ÿæˆéšæœºæ•°åºåˆ—$r_1, ..., r_n$ï¼›
  2. æŒ‰ç…§å‡½æ•°$f(x)$ç”Ÿæˆéšæœºæ•°åºåˆ—$x_1, ...x_n$ï¼›
  3. æ ¹æ®å‡½æ•°æ‰€å æ¯”ä¾‹è®¡ç®—ç§¯åˆ†å€¼ã€‚
- ä½¿ç”¨MCæ–¹æ³•è¿›è¡Œæ•°æ®æ¨¡æ‹Ÿã€‚

### éšæœºæ•°çš„äº§ç”Ÿ

- ç”¨ç‰©ç†æ–¹æ³•äº§ç”ŸçœŸéšæœºæ•°ï¼šä¸å¯é‡å¤ï¼Œäº§ç”Ÿé€Ÿåº¦æ…¢
- ç”¨æ•°å­¦æ–¹æ³•äº§ç”Ÿä¼ªéšæœºæ•°ï¼šå¯é‡å¤ï¼Œäº§ç”Ÿé€Ÿåº¦å¿«

éšæœºæ•°äº§ç”Ÿå­

### å‡½æ•°å˜æ¢æ³•ä¸èˆé€‰æ³•

#### å‡½æ•°å˜æ¢æ³•

è€ƒè™‘éšæœºå˜é‡$r= F(x)=\int f(x)\mathrm d x$
$$
g(r) \mathrm d r = f(x)\mathrm d x
$$

$$
g(r)=1
$$

æ•…çŸ¥éšæœºå˜é‡$r$ä¸ºå‡åŒ€åˆ†å¸ƒã€‚

å–$x = F^{-1}(r)$ï¼Œéšæœºç”Ÿæˆ0-1ä¹‹é—´çš„å‡åŒ€åˆ†å¸ƒï¼Œå°±å¯ä»¥å¾—åˆ°$x$çš„åˆ†å¸ƒã€‚

>å¯¹äºæŒ‡æ•°åˆ†å¸ƒ$f(x)=\mathrm e^{-x}$ï¼Œè¿›è¡Œå¤„ç†å¾—åˆ°ï¼š
>$$
>r= F(x)=1-\mathrm e ^{-x}
>$$
>
>$$
>x = -\ln (1-r)
>$$
>
>å®ç°ä»£ç å¦‚ä¸‹ï¼š
>
>```python
>import ROOT
>import math
>rnd = ROOT.TRandom3()
>
>hist = ROOT.TH1F('exp_distribution', 'hist', 40, 0, 5)
>
>for i in range(10000):
>    hist.Fill(-math.log(1-rnd.Rndm()))
>
>canvas = ROOT.TCanvas('canvas', 'Canvas', 800, 600)
>hist.Draw()
>
>canvas.SaveAs('exp_distribution.png')
>```
>
>![image-20250320170549321](https://raw.githubusercontent.com/stur007/img/main/img/202503201705876.png)

### è’™ç‰¹å¡ç½—æ–¹æ³•åœ¨ç‰©ç†å®éªŒä¸­çš„åº”ç”¨

### ä¹ é¢˜

1. å…¬å¹³çš„æŠ½ç­¾ï¼šè¢‹ä¸­æœ‰rä¸ªçº¢çƒä¸bä¸ªé»‘çƒï¼Œç°ä»»æ„ä¸æ”¾å›åœ°ä¸€ä¸€æ‘¸å‡ºï¼Œæ±‚äº‹ä»¶ç¬¬kæ¬¡æ‘¸å‡ºçº¢çƒçš„æ¦‚ç‡ï¼

   è§£ï¼š
   $$
   P(K)=\frac r {r+b}
   $$
   æ ·æœ¬ç©ºé—´
   $$
   n_\Omega = (r+b)!
   $$
   æˆåŠŸçš„æ¬¡æ•°
   $$
   n_A = r\cdot (r+b-1)!
   $$
   æ¦‚ç‡
   $$
   P(A) = \frac {n_A}{n_\Omega}= \frac r {r+b}
   $$

2. ç”Ÿæ—¥é—®é¢˜ï¼šæ±‚ä»»æ„nï¼ˆnâ‰¤365ï¼‰ä¸ªäººä¸­ï¼Œè‡³å°‘æœ‰ä¸¤ä¸ªäººç”Ÿæ—¥ç›¸åŒçš„æ¦‚ç‡ã€‚

   è§£ï¼š

   å°†äº‹ä»¶è½¬åŒ–æˆå¯¹ç«‹äº‹ä»¶è¿›è¡Œè®¡ç®—ã€‚$n$ä¸ªäººç”Ÿæ—¥å„ä¸ç›¸åŒçš„æ¦‚ç‡ä¸º
   $$
   P(\overline A)= \frac {n_{\overline A}}{n_\Omega}=\frac{\frac {365!}{(365-n)!}}{365^n}=(1-\frac 1 {365})\cdots(1-\frac {n-1}{365})
   $$

   $$
   P(A)=1-P(\overline A)
   $$

   

3. çº¦ä¼šé—®é¢˜ï¼šå°æ˜å’Œå°çº¢äºŒäººçº¦å®šåœ¨[0,T]æ—¶æ®µå†…å»æœªåæ¹–ä¼šé¢ï¼Œè§„å®šå…ˆåˆ°è€…ç­‰å€™ä¸€æ®µæ—¶é—´t(tâ‰¤T)å†ç¦»å¼€ã€‚è¯•æ±‚å°æ˜å’Œå°çº¢å°†ä¼šé¢çš„æ¦‚ç‡ã€‚

   è§£ï¼š

   ä¸¤äººå‡ºç°çš„æ—¶é—´èŒƒå›´åœ¨$[0, T]$ä¹‹é—´å‡åŒ€åˆ†å¸ƒï¼Œåœ¨ä¸¤è€…äº‹ä»¶ç›¸å·®çš„ç»å¯¹å€¼ä¸º$t$ä¹‹å†…çš„æƒ…å½¢å¯ä»¥ç›¸é‡ã€‚
   $$
   P(A)=\frac{n_A}{n_\Omega}=1-\frac {(T-t)^2}{T^2}
   $$

4. è´ç‰¹æœ—å¥‡è®ºï¼š1889 å¹´ï¼Œæ³•å›½æ•°å­¦å®¶è´ç‰¹æœ—æå‡ºä¸‹è¿°å‡ ä½•æ¦‚ç‡é—®é¢˜ï¼Œå¹¶ç»™å‡ºä¸‰ç§ä¸åŒçš„ç­”æ¡ˆã€‚è¿™å°±ä½¿æœ‰çš„äººå¯¹å½“æ—¶çš„æ¦‚ç‡è®ºä¸­çš„ä¸€äº›æ¦‚å¿µä¸æ–¹æ³•äº§ç”Ÿæ€€ç–‘ï¼Œå› æ­¤è¢«ç§°ä½œï¼‚å¥‡è®ºï¼‚ã€‚è¯·æ€è€ƒï¼š åœ¨å•ä½åœ†ä¸Šä»»ä½œä¸€å¼¦ï¼Œæ±‚å¼¦é•¿å¤§äº$\sqrt 3$çš„æ¦‚ç‡ï¼

   è§£ï¼š

   è¿™ä¸ä»»æ„çš„æ–¹å¼å…·æœ‰ç›¸å…³æ€§ï¼Œå¯¹äºä»»æ„çš„ç†è§£ä¸åŒä¼šå¯¼è‡´ç»“æœä¸åŒã€‚

   å¯ä»¥ä»»æ„å…ˆé€‰æ‹©åœ†å‘¨ä¸Šçš„ä¸€ä¸ªç‚¹ï¼Œç„¶åä»»æ„é€‰æ‹©ä¸€ä¸ªè§’åº¦ï¼›æˆ–è€…ä»»æ„é€‰æ‹©å¼¦çš„ä¸­ç‚¹çš„ä½ç½®ã€‚

   

5. æœ‰nä¸ªäººå‚åŠ èšä¼šï¼Œæ¯ä¸ªäººéƒ½éšèº«å¸¦äº†ä¸€ä»½ç¤¼ç‰©ï¼Œä¹‹åæŠŠç¤¼ç‰©æ··åˆæ”¾åœ¨ä¸€èµ·ã€‚ä¼šåæ¯ä¸ªäººéšæœºæ‹¿å–ä¸€ä»½ç¤¼ç‰©ã€‚æ±‚è‡³å°‘æœ‰ä¸€ä¸ªäººæ‹¿åˆ°äº†è‡ªå·±çš„ç¤¼ç‰©çš„æ¦‚ç‡ã€‚

   è§£ï¼š

   äº‹ä»¶$A_i$ä»£è¡¨ç¬¬iä¸ªäººæ‹¿åˆ°å±äºè‡ªå·±çš„ç¤¼ç‰©ï¼Œåˆ™
   $$
   P(\cup _{i= 1}^nA_i)=\frac {C_n^1}{A_n^1}- \frac {C_n^2}{A_n^2}+\cdots+(-1)^{n+1}\frac{C_n^n}{A_n^n}=1-\frac 1{2!}+\frac 1{3!}-\cdots+(-1)^{n+1}\frac 1 {n!}
   $$

   

6. æœ‰nä¸ªäººå‚åŠ èšä¼šï¼Œæ¯ä¸ªäººéƒ½éšèº«å¸¦äº†ä¸€ä»½ç¤¼ç‰©ï¼Œä¹‹åæŠŠç¤¼ç‰©æ··åˆæ”¾åœ¨ä¸€èµ·ã€‚ä¼šåæ¯ä¸ªäººéšæœºæ‹¿å–ä¸€ä»½ç¤¼ç‰©ã€‚æ±‚æ°å¥½æœ‰ k ä¸ªäººæ‹¿åˆ°äº†è‡ªå·±çš„ç¤¼ç‰©çš„æ¦‚ç‡ã€‚

   è§£ï¼š
   $$
   P= \frac 1{k!}\sum_{i= 1}^{n-k}\frac {(-1)^i}{i!}
   $$

7. äºŒé¡¹åˆ†å¸ƒï¼Œæ³Šæ¾åˆ†å¸ƒï¼Œé«˜æ–¯åˆ†å¸ƒçš„ç‰¹ç‚¹ä»¥åŠè½¬åŒ–å…³ç³»

   

8.  

   ![image-20250327153610018](https://raw.githubusercontent.com/stur007/img/main/img/202503271536604.png)

   è§£ï¼š
   $$
   P(N_a=n_0)= \int_a^1 \mathrm d x_1\int_{a/x_1}^1\mathrm d x_2\cdots\int_{a/x_1\cdots x_{n_0-2}}^1\mathrm d x_{n_0-1}\int_0^{a/x_1\cdots x_{n_0-1}}\mathrm d x_{n_0}=\frac a{(n_0-1)!}(-\ln a)^{n_0-1}
   $$
   
9. $Z = XY, X+Y, Y/X, \text{min}{X,Y}, \text{max}{X,Y}$ çš„éšæœºå˜é‡åˆ†å¸ƒ

   å®ä¾‹ï¼šè®¡ç®—å­˜åœ¨ä¸¤ç§è¡°å˜æ–¹å¼æ—¶çš„ç²’å­å¯¿å‘½ã€‚

   åˆ†æï¼š

   è®¾ç²’å­çš„å¯¿å‘½ä¸º$x$ï¼Œåˆ™ç²’å­å¯¿å‘½å°äºç­‰äº$a$çš„æ¦‚ç‡ï¼ˆç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼‰ï¼š
   $$
   H(a)= P(x\leq a)= 1-P(x>a)=1-P(x_1>a)P(x_2>a)=1-[1-F(a)][1-G(a)]
   $$
   åŒç†å¯ä»¥è®¡ç®—å‡º
   $$
   P(x\leq a)=P(x\leq a_1)P(x\leq a_2)
   $$
   ä¸‹é¢å¯¹å®ä¾‹è¿›è¡Œå¤„ç†ï¼š
   $$
   f(x) = \lambda_1\mathrm e ^{-\lambda_1 x}\\
   g(x)= \lambda_2\mathrm e^{-\lambda_2x}\\
   F(x)= 1-\mathrm e ^{-\lambda_1 x}\\
   G(x) = 1-\mathrm e^{-\lambda_2 x}\\
   H(x) = 1-\mathrm e^{-(\lambda_1 +\lambda_2) x}\\
   h(x)= (\lambda_1+\lambda_2)\mathrm e^{-(\lambda_1+\lambda_2)x}
   $$
   å¾—åˆ°ç²’å­å¯¿å‘½ï¼š
   $$
   \tau = \frac 1{\frac 1{\tau_1}+\frac 1{\tau_2}}
   $$
   

   ä¾‹ï¼š

   $X, Y U(0, 1),Z=\min(X,\, Y)/\max (X,\, Y)$

   ä»¤$u = \min,\, v = \max$
   $$
   f(u, v)= 2, 0\leq u\leq v \leq 1
   $$
   
10. æŸç²’å­åœ¨ A æ°”ä½“ä¸­çš„å¹³å‡è‡ªç”±ç¨‹ä¸º $L_A$ï¼Œåœ¨ B æ°”ä½“ä¸­çš„å¹³å‡è‡ªç”±ç¨‹ä¸º $L_B$ï¼Œæ±‚å®ƒåœ¨ AB ç­‰é‡æ··åˆæ°”ä½“ä¸­çš„å¹³å‡è‡ªç”±ç¨‹

11. ä¹ é¢˜ 1.13ï¼Œ 1.14ï¼Œ1.15 è®²è§£

    ç›¸å…³æ€§ï¼š==çº¿æ€§ç›¸å…³==ï¼Œå³ï¼š$Y=X^2$çš„å…³ç³»ä¸èƒ½å¾—åˆ°éªŒè¯

    ![image-20250309104031036](https://raw.githubusercontent.com/stur007/img/main/img/202503091040100.png)

    æ„é€ ç»Ÿè®¡é‡$U= Y-aX-b$ï¼Œè®¡ç®—$\sigma [U]$, $E[U]$, è¯æ˜äºŒè€…å‡ä¸ºé›¶å³å¯ã€‚

    ä¸å¦¨å–ï¼š
    $$
    b = E
    $$
    
12. é‡æœŸæœ›æ³•åˆ™
    $$
    E[E[X|Y]]=E[X]
    $$
    
13. Stein's lemma

14. ä¸€åçŸ¿å·¥è¢«å›°åœ¨ä¸€ä¸ªæœ‰ä¸‰æ‰‡é—¨çš„çŸ¿äº•ä¸­ã€‚å¦‚æœé€‰æ‹© 1 å·é—¨ï¼Œ3 å°æ—¶åå¯ä»¥åˆ°è¾¾å®‰å…¨åŒºåŸŸï¼›å¦‚æœé€‰æ‹© 2 å·é—¨ï¼Œ5 å°æ—¶åä¼šå›åˆ°åŸæ¥çš„ä½ç½®ï¼›å¦‚æœé€‰æ‹© 3 å·é—¨ï¼Œ7 å°æ—¶ä¼šå›åˆ°åŸæ¥çš„ä½ç½®ã€‚å¦‚æœå‡è®¾è¿™åçŸ¿å·¥å¯¹èµ°è¿‡çš„é—¨æ²¡æœ‰è®°å¿†ï¼Œæ¯æ¬¡éƒ½ä»¥ç›¸ç­‰çš„æ¦‚ç‡é€‰æ‹©æ¯æ‰‡é—¨ï¼Œé‚£ä¹ˆä»–å¹³å‡éœ€è¦å¤šå°‘æ—¶é—´æ‰èƒ½åˆ°è¾¾å®‰å…¨åŒºåŸŸï¼Ÿ
    $$
    \begin{aligned}
    &E[X|Y=1]=3\\
    &E[X|Y=2]=5+E[X]\\
    &E[X|Y=3]=7+E[X]\\
    &E[X]= E[E[X|Y]]=\frac 1 3(E[X|Y=1]+E[X|Y=2]+E[X|Y=3])
    \end{aligned}
    $$
    å¯ä»¥è§£å‡º$E[X]$ã€‚

15. Skewnessï¼ˆååº¦ï¼‰ ä¸ Kurtosisï¼ˆå³°åº¦ï¼‰

## chap 04 ç»Ÿè®¡æ£€éªŒ

### å‡è®¾ã€æ£€éªŒã€æ˜¾è‘—æ°´å¹³ã€åŠŸæ•ˆã€ä¸´ç•ŒåŸŸ

- å‡è®¾ hypothesisï¼ˆpl. hypothesesï¼‰

  å‡è®¾->ç‰©ç†ç†è®ºï¼šé¢„æµ‹æ•°æ®å‡ºç°çš„æ¦‚ç‡ï¼Œé€šè¿‡å®éªŒè¿›è¡Œæ£€éªŒã€‚

  ç®€å•å‡è®¾ï¼šç»™å‡ºçš„å‡è®¾$H_0$å¯ä»¥å®Œå…¨ç¡®å®šæ¦‚ç‡å¯†åº¦å‡½æ•°$f(x|H)$ï¼Œç§°ä¸ºå‡è®¾çš„ä¼¼ç„¶å€¼ï¼ˆlikelihoodï¼‰$L(x|H)$.

  >  å‡è®¾çš„ä¼¼ç„¶å€¼ï¼šå‡è®¾æˆç«‹æ—¶å¯è§‚æµ‹é‡$x$å‡ºç°çš„æ¦‚ç‡$f(x|H)$ï¼Œå³$x\sim f(x|H)$.

  ç¬¦åˆå‡è®¾ï¼šä»ç„¶åŒ…å«æœªç¡®å®šçš„å‚æ•°ã€‚

- æ£€éªŒ

  é›¶å‡è®¾ï¼ˆnull hypothesisï¼‰$H_0$ä¸å¤‡æ‹©å‡è®¾ï¼ˆalternative hypothesisï¼‰$H_1$ã€‚

  å¯¹ç®€å•å‡è®¾$H_0$çš„æ£€éªŒï¼šåœ¨å‡è®¾$H_0$æ­£ç¡®çš„æƒ…å½¢ä¸‹ï¼Œåœ¨ä¸´ç•ŒåŸŸ$W$å†…è§‚æµ‹åˆ°ç»“æœçš„==ï¼ˆå°ï¼‰==æ¦‚ç‡ä¸è¶…è¿‡$\alpha$ï¼Œå³
  $$
  P(x\in W|H_0)\leq \alpha
  $$
  $\alpha$ï¼š==æ˜¾è‘—æ€§æ°´å¹³/æ£€éªŒå¤§å°==

  > ä¸€èˆ¬æƒ…å½¢ä¸‹$\alpha$çš„å–å€¼èŒƒå›´åœ¨${10^{-6}\sim 10^{-7}}$ä¹‹é—´ã€‚

  ==ä¸´ç•ŒåŸŸ==ï¼š==æ‹’ç»åŸŸ==ï¼Œè¡¥é›†ç§°ä¸º==æ¥å—åŸŸ==ã€‚

- ç¬¬ä¸€ç±»é”™è¯¯ä¸ç¬¬äºŒç±»é”™è¯¯

  - ç¬¬ä¸€ç±»é”™è¯¯ï¼šå‡è®¾$H_0$ä¸ºçœŸï¼Œä½†æ˜¯å‡è®¾è¢«æ‹’ç»ã€‚è¿™ç±»é”™è¯¯çŠ¯é”™çš„æœ€å¤§æ¦‚ç‡$P(x\in W|H_0)$å°±æ˜¯æ˜¾è‘—æ€§æ°´å¹³$\alpha$ã€‚
  - ç¬¬äºŒç±»é”™è¯¯ï¼šå‡è®¾$H_0$ä¸ºå‡ï¼Œä½†æ˜¯å‡è®¾$H_1$ä¸ºçœŸã€‚è¿™ç±»é”™è¯¯çš„æ¦‚ç‡ä¸º$P(x\in S-W|H_1)=\beta$ï¼Œ$1-\beta$ç§°ä¸º==åŠŸæ•ˆ==ï¼ˆæ£€éªŒå¯¹äºæ’é™¤å¤‡æ‹©å‡è®¾$H_1$çš„æ•ˆåŠ›ï¼‰ã€‚

  > ä¸€èˆ¬è€Œè¨€ï¼Œè°ƒæ•´ä¸´ç•ŒåŸŸä¸å¯èƒ½ä½¿å¾—$\alpha$ä¸$\beta$åŒæ—¶å‡å°ï¼Œä½†æ˜¯å¢å¤§æ ·æœ¬é‡å¯ä»¥å®ç°è¿™ä¸€ç‚¹ã€‚

- ä¸´ç•ŒåŸŸçš„é€‰æ‹©ï¼šå•è¾¹æ£€éªŒä¸åŒè¾¹æ£€éªŒ

### ä¿¡å·æœ¬åº•çš„ç”„åˆ«

å¯¹äºä¸€æ¬¡æµ‹é‡çš„å®éªŒç»“æœé€šå¸¸ä¸æ­¢æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œè€Œæ˜¯ä¸€ä¸ªå‘é‡$\vec x = (x_1, x_2, \cdots x_n)$ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ æ£€éªŒç»Ÿè®¡é‡æ¥æ£€éªŒå‡è®¾æ˜¯å¦æ­£ç¡®ã€‚

#### æ£€éªŒç»Ÿè®¡é‡$t$

æ„é€ ä¸€ä¸ªæ ‡é‡æ£€éªŒç»Ÿè®¡é‡$t=t(x_1, x_2, \cdots ,x_n)$ï¼Œå¯¹å‡è®¾è¿›è¡Œæ£€éªŒã€‚æ£€éªŒç»Ÿè®¡é‡ä¹Ÿå¯ä»¥ç›´æ¥å–ä¸ºçŸ¢é‡$\vec t = \vec t(x_1, x_2, \cdots, x_n)$ã€‚

#### çº¯åº¦

äº‹ä¾‹é€‰æ‹©çš„çº¯åº¦ï¼šä¿¡å·äº‹ä¾‹è¢«æ­£ç¡®åˆ†ç±»çš„æ¦‚ç‡ã€‚ï¼ˆæ¢è¨€ä¹‹ï¼Œè¢«åˆ¤æ–­ä¸ºä¿¡å·çš„æ‰€æœ‰äº‹ä¾‹ä¸­çœŸæ­£ä¸ºä¿¡å·çš„äº‹ä¾‹æ‰€å çš„æ¯”ä¾‹ã€‚ï¼‰
$$
P(s|x \in W)=\frac{P(x\in W|s)P(s)}{P(x \in W|s)P(s)+P(x \in W|b)P(b)}
$$

#### æ£€éªŒæ•ˆç‡

ä¿¡å·äº‹ä¾‹è¢«æ¥å—çš„æ¦‚ç‡ï¼ˆè¢«æ¥å—çš„ä¿¡å·äº‹ä¾‹å æ‰€æœ‰ä¿¡å·äº‹ä¾‹çš„æ¯”ä¾‹ï¼‰

å³ï¼š
$$
\varepsilon_s = \int f(t|s)\mathrm d  t=1-\alpha
$$

### Neyman-Pearsonå¼•ç†ä¸æ£€éªŒç»Ÿè®¡é‡çš„æ„é€ 

å¯¹äºå¤šç»´ç»Ÿè®¡æ£€éªŒé‡ï¼Œåº”å½“å¦‚ä½•é€‰å–==æœ€ä½³==çš„ä¸´ç•ŒåŸŸï¼Ÿ

#### Neyman-Pearsonå¼•ç†

åœ¨ç»™å®šæ•ˆç‡çš„æ¡ä»¶ä¸‹ï¼Œæƒ³è¦å¾—åˆ°æœ€é«˜çº¯åº¦çš„ä¿¡å·æ ·æœ¬ï¼Œæ¥å—åŸŸçš„é€‰æ‹©å¯ä»¥ä¸ºï¼š
$$
\frac{g(\vec t|H_0)}{g(\vec t |H_1)}>c
$$
æ£€éªŒç»Ÿè®¡é‡å¯ä»¥å–ä¸º
$$
r = \frac{g(\vec t|H_0)}{g(\vec t|H_1)}
$$

> å¼•ç†çš„è¯æ˜(from https://chatgpt.com)
>
> ä¸‹é¢ç»™å‡ºå†…æ›¼â€“çš®å°”é€Šå¼•ç†ï¼ˆNeymanâ€“Pearsonå®šç†ï¼‰çš„ä¸€ä¸ªç»å…¸è¯æ˜ã€‚å‡è®¾æˆ‘ä»¬è¦åœ¨ä¸¤ç§ç®€å•å‡è®¾ä¹‹é—´åšå‡ºæ£€éªŒï¼š
>
> - é›¶å‡è®¾ $H_0$ï¼šéšæœºå˜é‡ $X$ çš„æ¦‚ç‡å¯†åº¦ï¼ˆæˆ–æ¦‚ç‡è´¨é‡ï¼‰å‡½æ•°ä¸º $p(x)$ï¼›
> - å¤‡æ‹©å‡è®¾ $H_1$ï¼š$X$ çš„å¯†åº¦ä¸º $q(x)$ã€‚
>
> æˆ‘ä»¬å¸Œæœ›æ„é€ ä¸€ä¸ªæ£€éªŒå‡½æ•° $\phi(x)$ï¼Œå…¶ä¸­  
> $$
> \phi(x)=
> \begin{cases}
> 1, & \text{æ‹’ç» } H_0,\\
> 0, & \text{æ¥å— } H_0.
> \end{cases}
> $$
> ï¼ˆä¸ºç®€å•èµ·è§ï¼Œä¹Ÿå¯ä»¥å…è®¸åœ¨è¾¹ç•Œç‚¹ä¸Šå–ä»‹äº 0 å’Œ 1 çš„å€¼ä»¥è°ƒæ•´ç²¾ç¡®æ°´å¹³ã€‚ï¼‰
>
> å®šç†çš„ç»“è®ºæ˜¯ï¼šåœ¨æ‰€æœ‰æ˜¾è‘—æ€§æ°´å¹³ä¸è¶…è¿‡ $\alpha$ çš„æ£€éªŒä¸­ï¼Œä»¥ä¼¼ç„¶æ¯”ä¸ºä¾æ®çš„æ£€éªŒ
> $$
> \phi^*(x)=
> \begin{cases}
> 1, & \text{å½“ } \displaystyle \frac{q(x)}{p(x)}>k,\\
> 0, & \text{å½“ } \displaystyle \frac{q(x)}{p(x)}<k,
> \end{cases}
> $$
> 
>
> ï¼ˆåœ¨ $\frac{q(x)}{p(x)}=k$ çš„ç‚¹ä¸Šå¯èƒ½éšæœºåŒ–ï¼Œä½¿å¾— $E_{H_0}[\phi^*(X)]=\alpha$ï¼‰å…·æœ‰æœ€å¤§çš„ç»Ÿè®¡åŠŸæ•ˆï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºä»»ä½•å…¶å®ƒæ£€éªŒ $\phi(x)$ï¼ˆå…¶ç¬¬ä¸€ç±»é”™è¯¯ç‡ä¸è¶…è¿‡ $\alpha$ï¼‰ï¼Œéƒ½æœ‰  
> $$
> E_{H_1}[\phi^*(X)]\ge E_{H_1}[\phi(X)].
> $$
> ä¸‹é¢æ˜¯è¯æ˜æ­¥éª¤ï¼š
>
> ---
>
> ### 1. æ„é€ æœ€ä¼˜æ£€éªŒ
>
> è®¾æˆ‘ä»¬æ„é€ çš„ä¼¼ç„¶æ¯”æ£€éªŒå‡½æ•°ä¸º
> $$
> \phi^*(x)=
> \begin{cases}
> 1, & \displaystyle \frac{q(x)}{p(x)}>k,\\
> \gamma(x), & \displaystyle \frac{q(x)}{p(x)}=k,\\
> 0, & \displaystyle \frac{q(x)}{p(x)}<k,
> \end{cases}
> $$
> å…¶ä¸­ $k>0$ å’Œ $\gamma(x)\in[0,1]$ å–å€¼ï¼Œä½¿å¾—è¯¥æ£€éªŒçš„æ˜¾è‘—æ€§æ°´å¹³æ»¡è¶³
> $$
> E_{H_0}[\phi^*(X)] = \int \phi^*(x)p(x)\,dx = \alpha.
> $$
>
> ---
>
> ### 2. å¯¹ä»»ä¸€æ°´å¹³ä¸è¶…è¿‡ $\alpha$ çš„æ£€éªŒæ¯”è¾ƒåŠŸæ•ˆ
>
> è®¾ä»»ä¸€å…¶å®ƒæ£€éªŒå‡½æ•°ä¸º $\phi(x)$ï¼Œæ»¡è¶³
> $$
> E_{H_0}[\phi(X)] = \int \phi(x)p(x)\,dx \le \alpha.
> $$
> æˆ‘ä»¬è¦è¯æ˜
> $$
> E_{H_1}[\phi^*(X)] - E_{H_1}[\phi(X)] \ge 0.
> $$
>
> ä¸ºæ­¤ï¼Œè€ƒè™‘ç§¯åˆ†
> $$
> I=\int \bigl[\phi^*(x)-\phi(x)\bigr]\Bigl[q(x)-k\,p(x)\Bigr]\,dx.
> $$
>
> **æ³¨æ„ï¼š** æ ¹æ® $\phi^*(x)$ çš„æ„é€ ï¼Œ
> - å½“ $\frac{q(x)}{p(x)}>k$ æ—¶ï¼Œ$\phi^*(x)=1$ï¼›æ­¤æ—¶ $q(x)-k\,p(x)>0$ï¼Œæ•… $\phi^*(x)-\phi(x)\ge 0$ æ—¶ä¹˜ä¸Šæ­£æ•°å¾—éè´Ÿï¼›
> - å½“ $\frac{q(x)}{p(x)}<k$ æ—¶ï¼Œ$\phi^*(x)=0$ï¼›æ­¤æ—¶ $q(x)-k\,p(x)<0$ï¼Œè€Œ $\phi^*(x)-\phi(x)=-\phi(x)\le 0$ï¼Œä¹˜ä¸Šè´Ÿæ•°ä¾ç„¶éè´Ÿï¼›
> - åœ¨ $\frac{q(x)}{p(x)}=k$ çš„ç‚¹ä¸Šï¼Œç”±äºå¯ä»¥é€šè¿‡éšæœºåŒ–è°ƒæ•´ï¼Œç§¯åˆ†å¯¹è¿™ä¸€å¤„çš„è´¡çŒ®ä¸ºé›¶ï¼ˆæˆ–å¯ä»¥å¿½ç•¥ï¼‰ã€‚
>
> å› æ­¤å¯ä»¥è¯æ˜ $I\ge 0$ã€‚
>
> ---
>
> ### 3. å°†ç§¯åˆ† $I$ ä¸å„æ£€éªŒçš„æœŸæœ›è”ç³»èµ·æ¥
>
> å°† $I$ å±•å¼€å¾—ï¼š
> $$
> I=\int \phi^*(x)q(x)\,dx - k\int \phi^*(x)p(x)\,dx - \left[\int \phi(x)q(x)\,dx - k\int \phi(x)p(x)\,dx\right].
> $$
> ä¹Ÿå°±æ˜¯è¯´ï¼Œ
> $$
> E_{H_1}[\phi^*(X)] - k\,E_{H_0}[\phi^*(X)] - \left[E_{H_1}[\phi(X)] - k\,E_{H_0}[\phi(X)]\right] \ge 0.
> $$
>
> ç”±äºæŒ‰æ„é€  $E_{H_0}[\phi^*(X)]=\alpha$ è€Œ $E_{H_0}[\phi(X)]\le \alpha$ï¼Œåˆ™
> $$
> E_{H_1}[\phi^*(X)] - k\alpha \ge E_{H_1}[\phi(X)] - k\,E_{H_0}[\phi(X)] \ge E_{H_1}[\phi(X)] - k\alpha.
> $$
> ä»è€Œå¯å¾—
> $$
> E_{H_1}[\phi^*(X)]\ge E_{H_1}[\phi(X)].
> $$
>
> è¿™è¯´æ˜åœ¨æ‰€æœ‰æ˜¾è‘—æ€§æ°´å¹³ä¸è¶…è¿‡ $\alpha$ çš„æ£€éªŒä¸­ï¼Œä¼¼ç„¶æ¯”æ£€éªŒ $\phi^*$ çš„åŠŸæ•ˆæ˜¯æœ€å¤§çš„ã€‚
>
> ---
>
> ### 4. æ€»ç»“
>
> ä»¥ä¸Šè¯æ˜åˆ©ç”¨äº†å¦‚ä¸‹å…³é”®æ€æƒ³ï¼š  
> - å°†ä¸¤ç§æ£€éªŒå‡½æ•°ä¹‹å·®ä¹˜ä»¥ $q(x)-k\,p(x)$ åç§¯åˆ†ï¼Œåˆ©ç”¨ä¼¼ç„¶æ¯”æ£€éªŒçš„æ„é€ ä¿è¯è¯¥ä¹˜ç§¯éè´Ÿã€‚  
> - ä»è€Œè¯æ˜äº†ä¼¼ç„¶æ¯”æ£€éªŒåœ¨ $H_1$ ä¸‹çš„æœŸæœ›ï¼ˆåŠŸæ•ˆï¼‰è‡³å°‘ä¸ä½äºä»»ä½•å…¶å®ƒåŒæ°´å¹³æ£€éªŒã€‚
>
> è¿™ä¾¿æ˜¯å†…æ›¼â€“çš®å°”é€Šå¼•ç†çš„è¯æ˜ï¼Œå…¶ç»“è®ºè¯´æ˜åœ¨ä¸¤ä¸ªç®€å•å‡è®¾çš„æƒ…å½¢ä¸‹ï¼ŒåŸºäºä¼¼ç„¶æ¯”çš„æ£€éªŒæ˜¯å‡åŒ€æœ€ä¼˜çš„ï¼Œå³åœ¨æ§åˆ¶ç¬¬ä¸€ç±»é”™è¯¯ç‡ï¼ˆæ˜¾è‘—æ€§æ°´å¹³ï¼‰çš„æ¡ä»¶ä¸‹ï¼Œå…¶åŠŸæ•ˆæœ€å¤§ã€‚
>
> ---
>
> ### å‚è€ƒ
>
> æœ¬è¯æ˜çš„æ€è·¯ä¸æ ‡å‡†æ•™æä¸­ç»™å‡ºçš„è¯æ˜ç±»ä¼¼ï¼Œä¾‹å¦‚å‚è§  
> - [ç»´åŸºç™¾ç§‘ï¼šå†…æ›¼â€“çš®å°”é€Šå¼•ç†](https://zh.wikipedia.org/wiki/%E5%86%85%E6%9B%BC%E2%80%93%E7%9A%AE%E5%B0%94%E6%A3%AE%E5%BC%95%E7%90%86)  
> - [çŸ¥ä¹ï¼šNeymanâ€“PearsonåŸºæœ¬å¼•ç†è¯æ˜](https://zhuanlan.zhihu.com/p/348803654)
>
> å¸Œæœ›è¿™ä¸ªè¯æ˜èƒ½å¸®åŠ©ä½ ç†è§£å†…æ›¼â€“çš®å°”é€Šå®šç†çš„åŸºæœ¬åŸç†å’Œæ•°å­¦æ¨å¯¼è¿‡ç¨‹ã€‚

#### çº¿æ€§æ£€éªŒç»Ÿè®¡é‡ã€è´¹èˆå°”(Fisher)ç”„åˆ«å‡½æ•°

$$
J(\boldsymbol a)= \frac{\boldsymbol a^TB\boldsymbol a}{\boldsymbol a^TW\boldsymbol a}
$$

æ³¨æ„åˆ°è¿™æ˜¯å…³äº$a$çš„é½æ¬¡å‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦åœ¨å›ºå®š$a$çš„æ¨¡é•¿çš„æƒ…å†µä¸‹è¿›è¡Œåå¯¼æ•°è¿ç®—ã€‚

ä¸å¦¨å‡è®¾ $\boldsymbol aW\boldsymbol a^T=1$ï¼Œå¾—åˆ°
$$
J(\boldsymbol a)=\boldsymbol a^TB\boldsymbol a-\lambda(\boldsymbol a^TW\boldsymbol a-1)
$$
å¯¹å…¶æ±‚åå¯¼æ•°$\frac{\partial J(\boldsymbol a)}{\partial \boldsymbol a}$å¾—åˆ°
$$
B\boldsymbol a=\lambda W\boldsymbol a
$$

$$
W^{-1}B\boldsymbol a=\lambda \boldsymbol a
$$

å³$\boldsymbol a$æ˜¯çŸ©é˜µ$W^{-1}B$çš„ç‰¹å¾å‘é‡ã€‚

å†æ³¨æ„åˆ°
$$
\begin{aligned}
B_{ij}a_j=(\mu_0-\mu_1)_i&\boxed{(\mu_0-\mu_1)_ja_j}=\lambda_a(\mu_0-\mu_1)_i\\
&= \lambda_a
\end{aligned}
$$
æœ€ç»ˆå¾—åˆ°ï¼š
$$
a \propto W^{-1}(\mu_0-\mu_1)
$$

åœ¨é«˜æ–¯åˆ†å¸ƒçš„æƒ…å½¢ä¸‹ï¼ŒFisheræ£€éªŒç»Ÿè®¡é‡ç»™å‡ºçš„ç»“æœä¸Neymann-Pearsonå¼•ç†çš„ç»“æœç›¸åŒã€‚åœ¨å…¶ä»–æƒ…å½¢ä¸‹å¹¶ä¸ç›¸åŒï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åšå˜æ¢å®ç°æ›´å¥½çš„ç»“æœã€‚

==ï¼ˆå¾…ç»­ï¼šé«˜æ–¯åˆ†å¸ƒæƒ…å½¢ä¸‹è¯æ˜ç›¸åŒï¼‰==

> ç¥ç»ç½‘ç»œï¼š
>
> - å•å±‚æ„ŸçŸ¥å™¨ï¼š
>
>   è¾“å…¥å±‚->è¾“å‡ºå±‚
>
> ![image-20250417173957171](https://raw.githubusercontent.com/stur007/img/main/img/202504171740088.png)
>
> - å¤šå±‚æ„ŸçŸ¥å™¨ï¼š
>
>   è¾“å…¥å±‚->éšè—å±‚->è¾“å‡ºå±‚
>
> ![image-20250417174025444](https://raw.githubusercontent.com/stur007/img/main/img/202504171740986.png)
>
> ç¡®å®šä¸­é—´çš„å‚æ•°æ˜¯æœºå™¨å­¦ä¹ æ ¸å¿ƒçš„å†…å®¹ï¼
>
> - è¿‡åº¦è®­ç»ƒ(overfitting)
>
>   å‚æ•°è¿‡å¤šï¼Œå¯¹è®­ç»ƒæ•°æ®çš„ç¬¦åˆéå¸¸å¥½ï¼Œä½†æ˜¯åè€Œä¸èƒ½å‡†ç¡®é¢„æµ‹å…¶ä»–æ•°æ®çš„ç»“æœã€‚
>
> ![image-20250417174520708](https://raw.githubusercontent.com/stur007/img/main/img/202504171745660.png)
>
> - è¾“å…¥å˜é‡é€‰æ‹©
>
>   å¦‚æœè¾“å…¥å˜é‡çš„ç›¸å…³æ€§è¾ƒå¼ºï¼Œå¸¸å¸¸å¯¹ç»“æœçš„å½±å“ä¸å¤§ã€‚å¦‚ï¼Œ$x^2, x^4$çš„ç»“æœå¸¸å¸¸åŒºåˆ«ä¸æ˜¯å¾ˆå¤§ï¼Œä¸€èˆ¬æƒ…å½¢ä¸‹ä¸éœ€è¦ä¿ç•™é«˜é˜¶çŸ©ã€‚

### æ£€éªŒæ‹Ÿåˆä¼˜åº¦ã€på€¼çš„å®šä¹‰ä¸åº”ç”¨

#### på€¼çš„å®šä¹‰

å¯¹äºç»™å®šçš„ç®€å•å‡è®¾$H_0$ï¼Œæˆ‘ä»¬å¯ä»¥å¯ä»¥é¢„æµ‹å‡ºå„ä¸ªç»“æœå‡ºç°çš„æ¦‚ç‡ã€‚å®éªŒä¸­çš„ç»“æœæ˜¯å…¶ä¸­ä¸€ç§ï¼Œè€ƒè™‘é¢„æœŸç»“æœä¸å¥½äºå®éªŒç»“æœçš„æ¦‚ç‡ï¼Œå®šä¹‰ä¸º$p$å€¼ã€‚å³ï¼š
$$
p=è§‚æµ‹åˆ°æ•°æ®\vec x ä¸å‡è®¾ğ»çš„ç¬¦åˆç¨‹åº¦ä¸å¥½äº å®é™…æ•°æ®\vec x_{obs}ä¸ğ»çš„ç¬¦åˆç¨‹åº¦çš„æ¦‚ç‡
$$

> ä¾‹å­ï¼šåœ¨æŠ›ç¡¬å¸å®éªŒä¸­ï¼Œä¸€å…±æŠ›æ·20æ¬¡ç¡¬å¸ï¼Œå®éªŒç»“æœä¸º17æ¬¡æ­£é¢å‘ä¸Šã€‚ä½†æ˜¯ï¼Œå®éªŒé¢„æœŸçš„æœ€æœ‰å¯èƒ½å‡ºç°çš„ç»“æœä¸º10ã€‚æ‰€ä»¥ï¼Œä¸å®éªŒç»“æœç›¸æ¯”ï¼Œæ›´ç³Ÿç³•æˆ–è€…ä¸€æ ·ç³Ÿç³•çš„é¢„æœŸç»“æœä¸º0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ17ï¼Œ18ï¼Œ19ï¼Œ20ã€‚æ ¹æ®äºŒé¡¹å¼åˆ†å¸ƒçš„è®¡ç®—å¯ä»¥å¾—åˆ°ï¼š
> $$
> p= P(N= 0,1,2,3,17,18,19,20)=0.0026
> $$
> å®éªŒä¸­ï¼Œæƒ³è¦æ£€éªŒå‡è®¾æ˜¯å¦æ­£ç¡®ï¼Œå¯ä»¥é‡å¤å®éªŒï¼Œæ£€æµ‹è¿™äº›æç«¯äº‹ä¾‹å‡ºç°çš„æ¦‚ç‡æ˜¯å¦ä¸$p$å€¼ç›¸ç¬¦ã€‚ï¼ˆ==å‡è®¾$H_0$ä¸ºçœŸçš„æ¦‚ç‡å¹¶ä¸æ˜¯$p$å€¼==ï¼‰

å¯¹äºè¿™ä¸€å®éªŒç»“æœï¼Œèƒ½ä¸èƒ½è®¤ä¸ºå‡è®¾$H_0$å¹¶ä¸æˆç«‹ï¼Ÿæ¢è¨€ä¹‹ï¼Œæœ‰å¤šå°‘ä¿¡å¿ƒï¼ˆBayesä¸»è§‚æ¦‚ç‡çš„è§’åº¦ï¼‰è®¤ä¸ºåŸå‡è®¾$H_0$æ­£ç¡®æˆ–è€…é”™è¯¯ï¼Ÿè¿™æ˜¯å‡è®¾æ£€éªŒä¸­çš„é‡è¦é—®é¢˜ã€‚

#### $H_0$çš„æ£€éªŒ

ç”±$p$å€¼çš„å®šä¹‰ï¼Œå®¹æ˜“çŸ¥é“ï¼š
$$
P(p_0\leq \alpha)=\alpha
$$

> è¯æ˜ï¼š
> $$
> p(t) = \int _t^\infty f(x)\mathrm d x\\
> g(p)= 1(ç´¯ç§¯åˆ†å¸ƒçš„éšæœºå˜é‡æ˜¯å‡åŒ€åˆ†å¸ƒ)\\
> \alpha = \int _{t_0}^\infty f(x)\mathrm d x\\
> P(p_0\leq \alpha)=\int_0^\alpha g(p)\mathrm d p=\alpha
> $$

### ä¿¡å·è§‚æµ‹çš„æ˜¾è‘—ç¨‹åº¦

è€ƒè™‘æ³Šæ¾è®¡æ•°å®éªŒï¼ˆå‡è®¾ä¿¡å·ä¸æœ¬åº•çš„æµ‹é‡ç»“æœå‡éµå¾ªæ³Šæ¾åˆ†å¸ƒï¼‰ï¼Œè®¾æœ¬åº•æ•°çš„å‡å€¼ä¸º$b$ï¼Œä¿¡å·çš„å‡å€¼ä¸º$s$ï¼Œ$H_0$ä¸ºæ²¡æœ‰ä¿¡å·äº§ç”Ÿï¼Œåˆ™ï¼š
$$
P(n|H_0)=\frac{b^n}{n!}\mathrm e ^{-b}
$$
å‡è®¾$b=0.5,\,n=5$ï¼Œé—®æ˜¯å¦å¯ä»¥è®¤ä¸ºå‘ç°äº†ä¿¡å·ï¼Ÿ

è§£ï¼š

è®¡ç®—på€¼ï¼š
$$
p = \sum_{n=5}^\infty\frac{b^n}{n!}\mathrm e ^{-b}=1.7\times10^{-4}
$$
æ˜¾è‘—æ€§$Z$ï¼šé«˜æ–¯å˜é‡åœ¨ä¸€ä¸ªæ–¹å‘æ¶¨è½å¾—åˆ°ç›¸åŒğ‘å€¼æ‰€å¯¹åº”çš„æ ‡å‡†å·®çš„å€æ•°ã€‚

### Pearson $\chi^2$æ£€éªŒ

#### $\chi^2$ç»Ÿè®¡é‡çš„å®šä¹‰

å®éªŒè§‚æµ‹å€¼ï¼š$\vec n =(n_1, n_2, ..., n_N)$

ç†è®ºé¢„æœŸå€¼ï¼š$\vec \mu = (\mu_1, \mu_2, ...\mu_N)$
$$
\chi^2=\sum_{i=1}^N\frac{(n_i-\mu_i)^2}{\sigma_i^2}
$$

## chap 05 å‚æ•°ä¼°è®¡çš„ä¸€èˆ¬æ¦‚å¿µ
### ä¼°è®¡é‡
#### é—®é¢˜
å¯¹äºæµ‹é‡ç»“æœ$\vec x_i$ï¼Œå¯¹äºæ¦‚ç‡å¯†åº¦å‡½æ•°çš„å‚æ•°æœ‰ä¼°è®¡$\hat \theta_i$ï¼Œé—®ï¼Œåº”è¯¥å¦‚ä½•å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå¾—åˆ°æœ€ä½³çš„ä¼°è®¡ç»“æœï¼Ÿå³ï¼Œå¦‚ä½•é€šè¿‡$\hat \theta$ä¼°è®¡$\theta$?

å¦‚æœç”¨æ›´åŠ æ•°å­¦çš„è¯­è¨€è¿›è¡Œè¡¨è¿°ï¼Œåœ¨å®é™…æ“ä½œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“æ¦‚ç‡å¯†åº¦å‡½æ•°$f(\vec x;\theta)$çš„å…·ä½“å½¢å¼ï¼Œåªèƒ½é€šè¿‡$n$æ¬¡æµ‹é‡çš„ç»“æœ$\vec x_1, ..., \vec x_n$å¯¹æ¦‚ç‡å¯†åº¦å‡½æ•°çš„å½¢å¼è¿›è¡Œä¼°è®¡ã€‚

> æµ‹é‡ç»“æœ$\vec x$ç§°ä¸º**æ ·æœ¬**ï¼Œä¼°è®¡é‡æ˜¯æ ·æœ¬çš„å‡½æ•°ã€‚ç»è¿‡å¤šæ¬¡æµ‹é‡ï¼Œå¯ä»¥å¾—åˆ°ä¼°è®¡é‡çš„åˆ†å¸ƒ$g(\hat \theta, \theta)$ã€‚

#### å¯¹ä¼°è®¡é‡çš„è¦æ±‚
- ç›¸åˆæ€§ï¼šåœ¨æ ·æœ¬å®¹é‡æ— é™å¤§çš„æé™ä¸‹ï¼Œä¼°è®¡é‡è¶‹è¿‘äºçœŸå€¼ã€‚
- æ— åæ€§ï¼š$b= E[\hat \theta]-\theta$è¶Šå°è¶Šå¥½ã€‚
- æœ‰æ•ˆæ€§ï¼šæ–¹å·®$V[\hat \theta]$è¶Šå°è¶Šå¥½ã€‚

å®šä¹‰å‡æ–¹è¯¯å·®MSE
$$
MSE=E[(\hat \theta-\theta)^2]=V[\hat \theta]+b^2
$$

> å¯¹äºåå€šä¸º0ï¼Œæ–¹å·®æœ€å°çš„ä¼°è®¡é‡ç§°ä¸ºæœ‰æ•ˆä¼°è®¡é‡ã€‚åœ¨$n\to \infty$çš„æƒ…å½¢ä¸‹åå€šè¶‹è¿‘äº0çš„ä¼°è®¡é‡ç§°ä¸ºæ¸è¿›æœ‰æ•ˆä¼°è®¡é‡ã€‚

ç„¶è€Œï¼Œåœ¨å®é™…æ“ä½œæ—¶ï¼Œå‡å°ä¼°è®¡é‡çš„æ–¹å·®ä¸å‡å°ä¼°è®¡é‡çš„åç§»æ˜¯ç›¸äº’çŸ›ç›¾çš„ï¼Œè¦è¿›è¡Œæƒè¡¡ã€‚
### æ ·æœ¬å‡å€¼
#### é—®é¢˜
å¯¹äºéšæœºå˜é‡$X$ï¼Œå…·æœ‰æœªçŸ¥çš„æ¦‚ç‡å¯†åº¦å‡½æ•°$f(x)$ï¼Œæƒ³è¦é€šè¿‡æœ‰é™æ¬¡<mark>ç‹¬ç«‹</mark>æµ‹é‡å¾—åˆ° $E[X]= \int f(x) \mathrm d x$ çš„ä¼°è®¡é‡ $\hat E[X]$ï¼Œé—®åº”è¯¥å¦‚ä½•æ„é€ å‡½æ•°å¾—åˆ°çš„è¿™ä¸€ä¼°è®¡å€¼ï¼Ÿ
> æ˜¾ç„¶ï¼Œè¿™ä¸€ä¼°è®¡é‡ä¸ºæ— å‚æ•°ä¼°è®¡é‡ã€‚
#### å‡½æ•°æ„é€ 
æ„é€ å‡½æ•°
$$
\mu = \frac{1}{n}\sum_{i=1}^nx_i
$$
#### å‡½æ•°æ€§è´¨æ£€éªŒ
##### ç›¸åˆæ€§
$$
lim_{n\to\infty}\mu = \overline x 
$$
(å¤§æ•°å¼±å®šå¾‹ä¿è¯)
##### åå€š
$$
E[\mu] = E[x] = \overline x 
$$
##### ä¼°è®¡é‡çš„æ–¹å·®
$$
\begin{aligned}
V[\mu] &= E[\mu^2]-E[\mu]^2\\
&=\frac{\sigma^2}{n}
\end{aligned}
$$

### æ ·æœ¬æ–¹å·®
#### å‡½æ•°æ„é€ 
å‡è®¾**åˆ†å¸ƒçš„å‡å€¼ä¸æ–¹å·®**éƒ½ä¸èƒ½æå‰ç¡®å®šç²¾ç¡®çš„å€¼ï¼Œæ„é€ å‡½æ•°ï¼š
$$
s^2 = \frac{1}{n-1}(\sum_{i=1}^{n}x_i^2-\mu^2)
$$

> æ³¨æ„ï¼Œè¿™é‡Œçš„å…¬å¼ä¸æ ·æœ¬çš„æ–¹å·®ä¸åŒï¼Œåˆ†æ¯å‡å»1çš„ä½œç”¨æ˜¯ï¼Œä¿è¯ä¼°è®¡é‡æ˜¯æ— åä¼°è®¡é‡ã€‚

#### å‡½æ•°æ€§è´¨æ£€éªŒ
##### æ–¹å·®ä¼°è®¡é‡çš„åå€š
$$
E[s^2] = V[X]
$$
##### æ–¹å·®ä¼°è®¡é‡çš„æ–¹å·®

![20250508165803](https://raw.githubusercontent.com/stur007/img/main/img/20250508165803.png)

### æ ·æœ¬åæ–¹å·®
![20250508165917](https://raw.githubusercontent.com/stur007/img/main/img/20250508165917.png)

## chap 06 æå¤§ä¼¼ç„¶æ³•
### ä¼¼ç„¶å‡½æ•°ã€æå¤§ä¼¼ç„¶ä¼°è®¡é‡
#### æœ€å¤§ä¼¼ç„¶æ³•çš„åŸºæœ¬æ€æƒ³

å‡è®¾å‡½æ•°åˆ†å¸ƒçš„å½¢å¼$f(x; \theta)$ï¼Œå¯¹äºå¤šæ¬¡æµ‹é‡$\vec x = (x_1, ... , x_n)$ï¼Œå¦‚ä½•ä¼°è®¡$\vec \theta = (\theta_1, ..., \theta_m)$?

$$
P(x_i \in [x_i, x_i + \mathrm d x_i])= \Pi_{i=1}^nf(x_i; \theta)\mathrm d x_i
$$

æˆ‘ä»¬ç›´è§‚ä¸Šæœ‰ç†ç”±ç›¸ä¿¡ï¼Œè§‚æµ‹åˆ°çš„ç»“æœå…·æœ‰ç›¸å¯¹è¾ƒé«˜çš„æ¦‚ç‡å€¼ã€‚

å®šä¹‰ä¼¼ç„¶å‡½æ•°ï¼š
$$
L(\vec x, \theta)= \Pi_{i=1}^n f(x_i; \theta)
$$

å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š
$$
\ln L(\vec x, \theta)= \sum_{i=1}^n\ln f(x_i; \theta)
$$

> ç»™å®šä¸€ç»„å®éªŒæ•°æ®ï¼Œä¼¼ç„¶å‡½æ•°å°±æ˜¯ä¼°è®¡é‡çš„å‡½æ•°ã€‚

æœ€å¤§ä¼¼ç„¶ä¼°è®¡é‡ï¼ˆMaximum Likelihood Estimatorï¼‰å®šä¹‰ä¸ºï¼šä½¿å¾—ä¼¼ç„¶å‡½æ•°å–æœ€å¤§å€¼çš„ä¼°è®¡é‡ï¼Œæ»¡è¶³ï¼š
$$
\frac{\partial L(\vec \theta)}{\partial \theta_i}=0
$$
> å‡†ç¡®æ¥è¯´ï¼Œä¸Šå¼æ±‚å‡ºçš„æ˜¯å¹³ç¨³å€¼çš„ä½ç½®ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä»ä¸­æŒ‘é€‰ä½¿å¾—Læœ€å¤§çš„å€¼å³å¯ã€‚

ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œä¸€èˆ¬æƒ…å½¢ä¸‹ï¼Œå¯ä»¥é€‰å–å‚æ•°çš„å‡½æ•°è¿›è¡Œå¤„ç†ï¼Œå³ï¼š
$$
\frac{\partial \ln L(h)}{\partial h}=0, \, h = h(\theta)
$$

> æœ€å¤§ä¼¼ç„¶æ³•çš„å¥½å¤„ï¼šåˆ©ç”¨äº†æ‰€æœ‰æ•°æ®çš„ä¿¡æ¯ï¼Œä¸åŒºé—´çš„åˆ’åˆ†æ— å…³ï¼Œå¯¹æµ‹é‡å€¼ä¸åšä»»ä½•çš„ä¿®æ­£ã€‚
> >å…³äºâ€œä¸åˆ†åŒºé—´æ˜¯å¦æœ‰å…³â€è¿™ä¸€ç‚¹ï¼Œå¯ä»¥é€šè¿‡ä¸æœ€å°äºŒä¹˜æ³•çš„å¯¹æ¯”æ¥ç†è§£ã€‚å¯¹äºæœ€å°äºŒä¹˜æ³•åœ¨åˆ†åŒºé—´çš„è¿‡ç¨‹ä¸­ï¼Œè·ç¦»è¾ƒè¿‘çš„ç‚¹çš„å€¼è¢«åˆå¹¶ï¼Œæ¯ä¸ªç‚¹çš„ä½œç”¨è¢«å‰Šå¼±ã€‚ä½†æ˜¯æœ€å¤§ä¼¼ç„¶æ³•ç€é‡äºâ€œè®¡æ•°â€çš„æ€§è´¨ï¼Œåˆå¹¶åŒºé—´å¹¶ä¸ä¼šé€ æˆå®è´¨æ€§çš„å½±å“ã€‚

> æœ€å¤§ä¼¼ç„¶æ³•çš„ç¼ºç‚¹ï¼š
>
>ä¸€èˆ¬æƒ…å†µä¸‹æœ€å¤§ä¼¼ç„¶æ³•ç»™å‡ºçš„ç»“æœä¸ä¼šéå¸¸ç³Ÿç³•ï¼ˆæ¸è¿›ï¼ˆ$n\to \infty$ï¼‰æœ‰æ•ˆï¼‰ï¼Œä½†æ˜¯åœ¨ä¸ªåˆ«æç«¯æƒ…å†µä¸‹ä¼šå¸¦æ¥é—®é¢˜ï¼ˆå¦‚$U[X]$ï¼Œä¼°è®¡éšæœºå˜é‡çš„èŒƒå›´ï¼‰ã€‚åŒæ—¶ï¼Œåœ¨å‚æ•°è¾ƒå¤šçš„æƒ…å½¢ï¼Œè¿™ä¸€æ–¹æ¡ˆçš„è®¡ç®—éš¾åº¦è¾ƒå¤§ã€‚

### ä¾‹å­ï¼šæŒ‡æ•°åˆ†å¸ƒä¸é«˜æ–¯åˆ†å¸ƒçš„ä¼°è®¡é‡ç¡®å®š
#### æŒ‡æ•°åˆ†å¸ƒ
åˆ†å¸ƒå½¢å¼ï¼š
$$
f(t;\tau)= \frac{1}{\tau}\mathrm e ^{-\frac{t}{\tau}}
$$

ç»™å®šå®éªŒæ ·æœ¬ä¹‹åï¼š
$$
\ln L(\tau)=-\sum_{i=1}^n \frac{t_i}{\tau}-n\ln\tau
$$

> å¯¹äºå®éªŒæ ·æœ¬ï¼Œè¦æ±‚ä¸ºç®€å•æ•°æ®æ ·æœ¬ï¼ˆæ„å‘³ç€å„æ¬¡æµ‹é‡ç‹¬ç«‹åŒåˆ†å¸ƒï¼‰ã€‚

ç”±æœ€å¤§ä¼¼ç„¶æ³•ï¼š

$$
\hat \tau = \frac{1}{n}\sum_{i=1}^nt_i
$$


##### ä¼°è®¡é‡çš„åå€š
ç”±äºå½¢å¼æ˜¯å¹³å‡å€¼çš„åˆ†å¸ƒï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æ— åä¼°è®¡é‡ã€‚

###### å¦ä¸€ç§æŒ‡æ•°åˆ†å¸ƒå½¢å¼çš„è¡¨è¾¾
$$
f(t; \lambda)=\lambda\mathrm e^{-\lambda t}
$$

æ˜¾ç„¶ä¼°è®¡é‡ä¸ºï¼š

$$
\hat \lambda=\frac{1}{\frac{1}{n}\sum_{i=1}^nt_i}
$$

ä½†æ˜¯è¿™ä¸€ä¼°è®¡é‡ä»…ä»…æ˜¯æ¸è¿‘æ— åçš„ã€‚

> ä½¿ç”¨ç‰¹å¾å‡½æ•°çš„æ–¹æ³•å¯ä»¥ç¡¬ç®—å¾—åˆ°æ¦‚ç‡å¯†åº¦åˆ†å¸ƒå‡½æ•°ï¼Œå¯ä»¥éªŒè¯ã€‚

#### é«˜æ–¯åˆ†å¸ƒ

$$
\ln L(\mu, \sigma^2)=\sum_{i=1}^n(\ln \frac{1}{\sqrt {2\pi }}+\frac{1}{2}\ln{\frac{1}{\sigma^2}}-\frac{(x_i-\mu)^2}{2\sigma^2} )
$$

å¾—åˆ°ï¼š

$$\hat \mu=\frac{1}{n}\sum_{i=1}^nx_i$$

$$
\hat \sigma^2=\frac{1}{n}\sum_{i=1}^n(x_i-\hat \mu)^2
$$

> æ˜¾ç„¶ï¼Œå‡å€¼çš„ä¼°è®¡é‡æ˜¯æ— åä¼°è®¡é‡ï¼Œæ–¹å·®çš„ä¼°è®¡é‡æ˜¯æ¸è¿‘æ— åä¼°è®¡é‡ã€‚

### ä¼°è®¡é‡çš„æ–¹å·®

#### ä½¿ç”¨MCæ–¹æ³•ç¡®å®šä¼°è®¡é‡çš„æ–¹å·®

å…·ä½“è€Œè¨€ï¼Œå°†ä¼°è®¡å€¼ä½œä¸ºçœŸå€¼ï¼Œè¿›è¡Œå¤šæ¬¡MCæ¨¡æ‹Ÿï¼Œè®¡ç®—æ•°æ®æ ·æœ¬çš„æ–¹å·®$s^2$è¿‘ä¼¼ä½œä¸ºä¼°è®¡é‡çš„æ–¹å·®çš„å€¼ã€‚

#### ä½¿ç”¨è§£ææ–¹æ³•ç¡®å®šä¼°è®¡é‡çš„æ–¹å·®

å¯¹äºå¸¸è§çš„åˆ†å¸ƒå½¢å¼ï¼Œç›´æ¥ç§¯åˆ†è®¡ç®—ä¼°è®¡é‡çš„æ–¹å·®æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å½¢ä¸‹çš„è®¡ç®—æ˜¯å›°éš¾çš„ã€‚

#### ä½¿ç”¨RCFè¾¹ç•Œç¡®å®šä¼°è®¡é‡çš„æ–¹å·®

ä¿¡æ¯ä¸ç­‰å¼ï¼š

$$
V[\theta]=\frac{(1+\frac{\partial b}{\partial \theta})^2}{E[-\frac{\partial^2 \ln L}{\partial \theta^2}]}
$$

å¦‚æœæœ€å¤§ä¼¼ç„¶ä¼°è®¡é‡(MLä¼°è®¡é‡)ä¸ºæœ‰æ•ˆä¼°è®¡é‡ï¼Œåˆ™$V[\hat \theta]\approx\frac{1}{-E[-\frac{\partial^2 \ln L}{\partial \theta^2}]}$ã€‚

å¯¹äºé«˜ç»´æƒ…å½¢ï¼š

![20250510101604](https://raw.githubusercontent.com/stur007/img/main/img/20250510101604.png)

#### ä½¿ç”¨å›¾è§£æ³•ç¡®å®šä¼°è®¡é‡çš„æ–¹å·®
ç”¨MLä¼°è®¡é‡å¤„çš„å€¼ä¼°è®¡ä¸ç¡®å®šåº¦ï¼Œå¯ä»¥çœ‹å‡ºï¼š
$$
\begin{aligned}
\ln L(\theta)&=\ln L(\hat \theta)+\frac{\partial \ln L(\theta)}{\partial \theta}|_{\theta = \hat\theta}(\theta - \hat \theta)+\frac{1}{2}\frac{\partial^2 \ln L}{\partial \theta^2}|_{\theta = \hat \theta}(\theta-\hat \theta)^2\\
&=\ln L(\hat \theta)-0.5\frac{(\theta-
\hat\theta)^2}{V[\theta]}
\end{aligned}
$$
å¯ä»¥çœ‹å‡ºï¼Œåœ¨å›¾ä¸­$\ln L$ä¸‹é™ä¸º0.5æ—¶çš„åŠå®½åº¦ä¸ºæ–¹å·®çš„ä¼°è®¡å€¼ã€‚

### æ‰©å±•çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡
è§£å†³çš„æ˜¯æ ·æœ¬å®¹é‡ä¸å›ºå®šçš„æƒ…å½¢ã€‚åœ¨å®éªŒè¿‡ç¨‹ä¸­ï¼Œæ ·æœ¬ç©ºé—´çš„å¤§å°nä¹Ÿæ˜¯éšæœºå˜é‡ï¼ˆä¸€å®šæ—¶é—´å†…è¡°å˜äº‹ä¾‹å‘ç”Ÿçš„æ¬¡æ•°ï¼‰ã€‚å®¹æ˜“çœ‹å‡ºï¼Œäº‹ä¾‹å‘ç”Ÿçš„æ¬¡æ•°ï¼ˆæ ·æœ¬ç©ºé—´çš„å¤§å°ï¼‰æ»¡è¶³å‡å€¼ä¸º$\nu$çš„æ³Šæ¾åˆ†å¸ƒã€‚

$$
L(\nu;\theta) = \frac{\nu^n}{n!}\mathrm e^{-\nu}\prod _{i=1}^n f(x_i;\theta)
$$

#### å‡å€¼ä¸æœªçŸ¥å‚æ•°ç›¸å…³çš„æƒ…å½¢

$$
\begin{aligned}
\ln L(\nu; \theta)&=n\ln\nu(\theta)-\nu(\theta)-\ln(n!)+\sum_{i=1}^n\ln f(x_i;\theta)\\
&=c-\nu(\theta)+\sum_{i=1}^n\ln(\nu(\theta)\cdot f(x_i, \theta))
\end{aligned}
$$

æ‰©å±•çš„æœ€å¤§ä¼¼ç„¶å‡½æ•°åˆ©ç”¨äº†æ ·æœ¬ç©ºé—´å¤§å°çš„ä¿¡æ¯ï¼Œç†è®ºä¸Šå¯ä»¥å‡å°ä¸ç¡®å®šåº¦ã€‚

> $\vec x = (x_1, x_2, ..., x_n), X_i \sim N(\mu, \sigma^2)$ï¼Œåˆ™å‡å€¼$\sim N(\mu, \sigma^2/n)$ã€‚


#### å‡å€¼ä¸æœªçŸ¥å‚æ•°æ— å…³çš„æƒ…å½¢
æ­¤æ—¶ï¼š
$$
\ln L(\nu,\theta)=c+\sum_{i=1}^n\ln \nu f(x_i, \theta)
$$

å½¢å¼ä¸æ ·æœ¬ç©ºé—´çš„å¤§å°å›ºå®šæ—¶ç›¸åŒï¼Œä½†æ˜¯è¿™æ ·çš„å½¢å¼æœ‰åˆ©äºå¤„ç†$f(x)$å·²çŸ¥æœ‰ä¸åŒæˆåˆ†å åŠ çš„æƒ…å½¢ã€‚

> ä¾‹å¦‚ï¼Œ$f(x)=\frac{\mu_s}{\mu_s+\mu_b}f_s(x)+\frac{\mu_b}{\mu_s+\mu_b}f_b(x)$ï¼Œä½¿ç”¨æ‰©å±•çš„æå¤§ä¼¼ç„¶ä¼°è®¡çš„ç»“æœå…·æœ‰æ›´åŠ ç›´è§‚çš„â€œäº‹ä¾‹æ•°â€çš„ä¼°è®¡çš„æ„ä¹‰ã€‚

> å¯¹äºéç‰©ç†ç»“æœï¼Œï¼ˆæœ¬åº•ä¿¡å·è¾ƒå¤§æ—¶ä¿¡å·çš„ä¼°è®¡å€¼æ—¶æ˜¯è´Ÿæ•°ï¼‰ï¼Œä¹Ÿåº”è¯¥æŒ‰ç…§ç»Ÿè®¡æ¶¨è½æ¥æ­£å¸¸è®°å½•ã€‚


### åˆ†åŒºé—´æ•°æ®çš„æå¤§ä¼¼ç„¶ä¼°è®¡

åœ¨æ•°æ®åˆ†åŒºé—´çš„æƒ…å½¢ä¸‹ï¼Œå¯ä»¥å¯¹åˆ†åŒºé—´æ•°æ®è¿›è¡Œæ‹Ÿåˆã€‚æ ¹æ®å‡è®¾ï¼Œå¾—åˆ°é¢„æœŸçš„åŒºé—´å†…çš„äº‹ä¾‹æ•°ï¼š$\vec \nu = (\nu_1, ..., \nu_n)$ï¼Œä¼¼ç„¶å‡½æ•°ä¸ºå¤šé¡¹åˆ†å¸ƒï¼Œå¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„ç»“æœä¸ºï¼š

$$
\ln L = \sum_{i=1}^nn_i\nu_i(\theta)
$$
> ç›¸æ¯”äºç‚¹ä¼°è®¡(unbinned ML)ï¼Œè¯¯å·®ç¨å¤§ï¼Œä½†æ˜¯å½±å“ä¸å¤§ã€‚

> å¯¹äºæ‹Ÿåˆä¼˜åº¦æ£€éªŒï¼Œä¸€èˆ¬å¯ä»¥ç›´æ¥åˆ©ç”¨MLæ–¹æ³•å¯¹$\ln L$è¿›è¡Œæ¨¡æ‹Ÿï¼Œpå€¼çš„ç¡®å®šå°±æ˜¯$P(\ln L\leq\ln L_{actual})$ã€‚

### ä¸ç­‰ç²¾åº¦ä¼¼ç„¶ç»“æœçš„åˆå¹¶
å‡è®¾å¯¹$\mu$è¿›è¡Œç‹¬ç«‹æµ‹é‡$n$æ¬¡ï¼Œæµ‹é‡ç»“æœä¸º$x_i\pm\sigma_i$,ä¸”$x_i\sim N(\mu, \sigma_i^2)$ã€‚ä½¿ç”¨æœ€å¤§ä¼¼ç„¶æ³•å¯¹$\mu$è¿›è¡Œä¼°è®¡ï¼Œå¾—åˆ°ï¼š

$$
\ln L(x_i, \mu)=c-\frac{1}{2}\sum_{i=1}^n\frac{(x_i-\mu)^2}{\sigma_i^2}
$$

$$
\frac{\partial \ln L}{\partial \mu}=0\Rightarrow\sum_{i=1}^n\frac{x_i-\hat \mu}{\sigma_i^2}=0
$$

$$
\hat \mu=\frac{\sum_{i=1}^nw_ix_i}{\sum_{i=1}^nw_i},\,w_i = \frac{1}{\sigma_i^2}
$$

ç”±å„ä¸ªæµ‹é‡é‡ç›¸äº’ç‹¬ç«‹ï¼Œå¯ä»¥æ–¹ä¾¿çš„è®¡ç®—å‡º
$$
\sigma_{\hat \mu}=\frac{1}{\sum_{i=1}^nw_i}
$$

> å¯¹æ‰€æœ‰æµ‹é‡ç»“æœçš„åˆå¹¶ï¼Œä¸ç¡®å®šåº¦ä¸€å®šæ¯”ä»»ä½•ä¸€æ¬¡æµ‹é‡çš„ç»“æœæ›´ä½ã€‚

>å¯¹äºæƒé‡å› å­ä¹Ÿå¯ä»¥æŒ‰ç…§è¿™ç§æ–¹å¼è¿›è¡Œå®šä¹‰ï¼Œæœ¬è´¨æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚
>
>![20250515154116](https://raw.githubusercontent.com/stur007/img/main/img/20250515154116.png)
## chap 07 æœ€å°äºŒä¹˜æ³•
### æœ€å°äºŒä¹˜æ³•ä¸æœ€å¤§ä¼¼ç„¶æ³•ä¹‹é—´çš„å…³ç³»
å¯¹äº$n$ä¸ªç›¸äº’ç‹¬ç«‹çš„é«˜æ–¯å˜é‡$Y_i$ï¼Œå¯¹æ•°ä¼¼ç„¶å‡½æ•°å¯ä»¥ç›´æ¥ç­‰ä»·äºï¼š

$$
\chi^2= \sum_{i=1}^n\frac{(y_i-\lambda(x_i;\theta))^2}{\sigma_i^2}å–æœ€å°å€¼ã€‚
$$

$\lambda_i$ä¸ºå¾…ç¡®å®šçš„çœŸå€¼ï¼Œ$\lambda_i =\lambda(x_i; \theta)$ï¼Œ$x_i$è®¤ä¸ºæ˜¯ç²¾ç¡®æµ‹é‡çš„ç»“æœã€‚

å¯¹äºå¹¶ä¸ç›¸äº’ç‹¬ç«‹çš„é«˜æ–¯å˜é‡ï¼Œä½†æ˜¯å¯ä»¥ç”¨é«˜ç»´é«˜æ–¯å¯†åº¦å‡½æ•°åˆ†å¸ƒæè¿°çš„ç»“æœï¼Œå¯ä»¥å†™ä¸ºï¼š
$$
\chi^2=\sum_{i,j = 1}^n(y_i-\lambda(x_i;\theta))V^{-1}_{ij}(y_j-\lambda(x_j;\theta))å–æœ€å°å€¼ã€‚
$$

å¯¹äºä¸æ˜¯é«˜æ–¯åˆ†å¸ƒçš„æƒ…å½¢ï¼ˆä¸€èˆ¬æƒ…å½¢ä¸‹åç¦»ä¸å¤ªå¤šï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨$\chi^2$æœ€å°å€¼æ¥ç¡®å®šå‚æ•°çš„å–å€¼ã€‚
### çº¿æ€§æƒ…å½¢ä¸‹çš„æœ€å°äºŒä¹˜ä¼°è®¡
å¯¹äº$\lambda$å¯¹å„ä¸ªå‚æ•°$\theta_j,\,j=1, .., m$çº¿æ€§çš„æƒ…å½¢ï¼š

$$
\lambda_i = \sum_{j=1}^ma_j(x_i)\theta_j,\,a_j(x)æ˜¯ä»»æ„çº¿æ€§ç‹¬ç«‹å‡½æ•°ã€‚
$$

æ­¤æ—¶å¾—åˆ°çš„ä¼°è®¡é‡æ˜¯æœ‰æ•ˆä¼°è®¡é‡ã€‚ï¼ˆæ— åä¸”æ–¹å·®æœ€å°ï¼‰

è®¾$\bold A:A_{ij}=a_j(x_i)$ï¼Œåˆ™$\vec \lambda = \bold A\vec \theta$ã€‚

$$
\begin{aligned}
\chi^2&=(\vec y-\bold A\vec \theta)^T\bold V^{-1}(\vec y-\bold A\vec \theta)\\
&=-\bold A^T\bold V^{-1}(\vec y-\bold A\vec \theta)-(\vec y-\bold A\vec\theta)^T\bold V^{-1}\bold A
\end{aligned}
$$

$$
\hat {\vec \theta} =(\bold A^T\bold V^{-1}\vec A)^{-1}\bold A^T\bold V^{-1}\vec y=:\bold B \vec y
$$

è®¡ç®—å‚æ•°ä¼°è®¡çš„åæ–¹å·®çŸ©é˜µï¼š

$$
\bold U = \bold {BVB^T}=(\bold {AV^{-1}A^T})^{-1}=(\frac{1}{2}\nabla\nabla\chi^2)^{-1}
$$

æ¢è¨€ä¹‹ï¼Œ
$$
\chi^2(\hat{\vec\theta}\pm\sigma_{\hat{\vec\theta}})=\chi_{min}^2+1
$$

> åœ¨é«˜æ–¯åˆ†å¸ƒçš„å½¢å¼ä¸‹ï¼Œç”±äº$\chi^2=-2\ln L+c$ï¼Œå¯ä»¥å¯¹åº”äºæœ€å¤§ä¼¼ç„¶æ³•çš„å›¾è§£æ³•æ¡ä»¶ã€‚

> è¿™ä¸€èŒƒå›´ç¡®å®šä¸‹æ¥çš„$\vec \theta$åŒºé—´ç§°ä¸ºç½®ä¿¡åŒºé—´ã€‚

### å¤šé¡¹å¼çš„æœ€å°äºŒä¹˜æ‹Ÿåˆ
ä½œä¸ºçº¿æ€§ä¼°è®¡é‡çš„ä¸€ä¸ªå®ä¾‹ï¼Œè€ƒè™‘å¤šé¡¹å¼çš„å‡è®¾ä¸ºï¼š

$$
\lambda(x_i;\vec\theta)=\sum_{i=1}^m\theta_ix_i^{i-1}
$$

å½“å¤šé¡¹å¼è‡ªç”±å˜é‡$m+1=n$æ—¶ï¼Œ$\chi^2=0$æ’æˆç«‹ï¼Œä¼°è®¡æ— æ„ä¹‰ã€‚ï¼ˆè¿‡æ‹Ÿåˆï¼‰

> éçº¿æ€§æœ€å°äºŒä¹˜æ³•æ‹Ÿåˆä¼°è®¡ï¼šä¸€èˆ¬æƒ…å½¢$\lambda(x;\vec\theta)$ä¸‹åªèƒ½è¿›è¡Œæ•°å€¼æ±‚è§£ã€‚

> æœ‰çº¦æŸæƒ…å½¢ä¸‹çš„æœ€å°äºŒä¹˜æ‹Ÿåˆ
> 
>ä¸ºäº†ç®€å•èµ·è§ï¼Œä»…è€ƒè™‘æ— å‚æ•°çš„æœ€å°äºŒä¹˜æ‹Ÿåˆã€‚ä½¿ç”¨Lagrangeä¹˜å­æ³•è®¡ç®—
>
> $$
> \chi^2(\vec x, \vec \alpha)=(\vec x ^\prime -\vec x )^T\bold V^{-1}(\vec x^\prime -\vec x)+2\vec \psi^T\alpha
> $$
>
> çš„æœ€å°å€¼å³å¯ã€‚

### æ£€éªŒæœ€å°äºŒä¹˜æ³•çš„æ‹Ÿåˆä¼˜åº¦
$\chi_{min}^2$çš„å¤§å°å†³å®šäº†æ•°æ®ä¸å‡è®¾ä¹‹é—´çš„ç¬¦åˆç¨‹åº¦ï¼Œè¿›è€Œå¯ä»¥ç›´æ¥ç”¨æ¥æ£€éªŒæ‹Ÿåˆä¼˜åº¦ã€‚

å¦‚æœ$n$ä¸ªå˜é‡ç›¸äº’ç‹¬ç«‹çš„é«˜æ–¯åˆ†å¸ƒå˜é‡ï¼Œç”±å®šä¹‰$\chi^2$æ˜¾ç„¶æ»¡è¶³è‡ªç”±åº¦ä¸º$n-m$çš„å¡æ–¹åˆ†å¸ƒã€‚

å¦‚æœ$\chi_{\min}^2$è¾ƒå°ï¼Œåªèƒ½è¯´æ˜å®éªŒæ•°æ®ä¸å½“å‰å‡è®¾ç›¸å¯¹ç¬¦åˆã€‚

> â€œè¾ƒå°â€çš„æ ‡å‡†:$E[\chi^2(n_d)]=n_d$ï¼Œè®¤ä¸ºæ˜¯å¯ä»¥æ¥å—çš„ç»“æœã€‚

> æ‹Ÿåˆä¼˜åº¦ä¸ç»Ÿè®¡ä¸ç¡®å®šåº¦ä¹‹é—´çš„å…³ç³»ï¼šç»Ÿè®¡ä¸ç¡®å®šåº¦å¯¹åº”äº$\chi^2$åœ¨æœ€å°å€¼é™„è¿‘çš„å˜åŒ–å¿«æ…¢ï¼Œæ‹Ÿåˆä¼˜åº¦å¯¹åº”$\chi^2_{\min}$çš„å¤§å°ã€‚æ¢è¨€ä¹‹ï¼Œæ‹Ÿåˆä¼˜åº¦ä¸æµ‹é‡çš„ä¸ç¡®å®šåº¦ç›´æ¥å¹¶æ²¡æœ‰ç›´æ¥çš„å…³ç³»ã€‚
>
> ä¾‹å¦‚ï¼Œå¦‚æœå¯¹æŸæ¬¡æµ‹é‡çš„ç»“æœè¿›è¡Œä¸Šä¸‹â€œå¹³ç§»â€çš„åŒæ—¶ä¿æŒè¯¯å·®ä¸å˜ï¼Œå¯¹äºå‚æ•°çš„ä¼°è®¡å€¼çš„è¯¯å·®ä¿æŒä¸å˜ï¼Œä½†æ˜¯$\chi^2_{\min}$çš„å€¼å¯ä»¥å˜å¤§æˆ–å˜å°ã€‚

### æœ€å°äºŒä¹˜æ³•å¤„ç†åˆ†åŒºæ•°æ®
å¯¹ç›´æ–¹å›¾è¿›è¡Œæ‹Ÿåˆã€‚å‡è®¾$X$çš„æ¦‚ç‡å¯†åº¦åˆ†å¸ƒå‡½æ•°$f(x;\theta)$ï¼Œ$Y_i$ä¸ºç¬¬$i$ä¸ªåŒºé—´çš„é¢‘æ•°ï¼Œåˆ™$\lambda_i=n\int_{x_\min}^{x_\max} f(x;\theta)\mathrm d x=np_i(\vec \theta)$ã€‚å‡è®¾åŒºé—´çš„å®½åº¦è¶³å¤Ÿå°ï¼Œåˆ™$Y_i$å¯ä»¥çœ‹ä½œæ˜¯æ³Šæ¾å˜é‡ã€‚
### æµ‹é‡ç»“æœçš„åˆå¹¶

## chap 08 çŸ©æ–¹æ³•

## chap 09 ç»Ÿè®¡æ¨æ–­ä¸ä¿¡æ¯ã€å†³ç­–ã€ç½®ä¿¡åŒºé—´

## chap 10 è§£è°±æ³•

## é™„å½•ï¼šæ¦‚ç‡è®ºæ²‰æ€å½•

### chap 01 åˆæƒ…æ¨ç†

1. å¼ºä¸‰æ®µè®ºï¼ˆæ¼”ç»æ¨ç†ï¼‰ï¼šAçœŸ -> BçœŸï¼ŒAçœŸï¼Œåˆ™BçœŸ

   å¼±ä¸‰æ®µè®ºï¼ˆåˆæƒ…æ¨ç†ï¼‰ï¼šAçœŸ -> BçœŸï¼ŒBçœŸï¼Œåˆ™Aæ›´åˆæƒ…

2. å¸ƒå°”ä»£æ•°ï¼š

   ç§¯ï¼šABï¼ˆAä¸BåŒæ—¶ä¸ºçœŸï¼Œåˆ™ä¸ºçœŸï¼‰

   å’Œï¼šA+Bï¼ˆAæˆ–Bä¸ºçœŸï¼Œåˆ™ä¸ºçœŸï¼‰

   å¦ï¼š$\overline{A}$ ï¼ˆAä¸ºå‡ï¼‰

   > - å†™æˆåŠ æ³•ä¸ä¹˜æ³•çš„å½¢å¼ï¼Œä¸ºäº†ç›´æ¥è¿ç”¨åŠ æ³•ä¸ä¹˜æ³•çš„è¿ç®—å¾‹ã€‚
   >
   > - è¿ç®—çš„å®ä¾‹ï¼š
   >   - $AA=A$ï¼Œ$A \overline A =False(0)$ï¼Œ$0 + A = A$ï¼Œ$\overline{\overline{A}}=A$ï¼Œ$A+A=A$
   >   - $A+\overline{A}=True(1)$ï¼Œ$True(1)A=A$
   >   - $\overline{A}+A\overline{B}=\overline{AB}$

3. è•´å«å…³ç³»

   $A\Rightarrow B$ ï¼ˆAä¸ºçœŸï¼Œåˆ™Bä¸ºçœŸï¼›Bä¸ºå‡ï¼Œåˆ™Aä¸ºå‡ï¼‰

   ç”¨å¸ƒå°”ä»£æ•°è¡¨è¾¾ï¼š$A = AB$ ï¼Œå¯ä»¥éªŒè¯æ»¡è¶³ä¸Šé¢çš„è•´å«å…³ç³»çš„å®šä¹‰ã€‚

   > $A\Rightarrow B$çš„å¸ƒå°”å€¼ä¸$\overline{A}+B$çš„å¸ƒå°”å€¼ç›¸åŒã€‚

4. é€»è¾‘å‡½æ•°

   å¯¹$n$ä¸ªå‘½é¢˜ï¼Œæœ€å¤šæœ‰$2^{n+1}$ä¸ªä¸åŒçš„æ¦‚ç‡å‡½æ•°ã€‚ï¼ˆnä¸ªå‘½é¢˜æœ‰$2^n$ç§ç»“æœï¼Œå‡½æ•°å¯èƒ½æœ‰ä¸¤ç§å–å€¼ï¼‰

   > $2^{n+1}$ç§å‡½æ•°ï¼Œå¯ä»¥ç®€åŒ–ä¸ºè§„èŒƒæå–èŒƒå¼ï¼ˆå½¢å¦‚$A_1...A_n$ï¼Œ$\overline{A_1}...A_n$çš„åˆå–ï¼ˆäº¤/ä¹˜ç§¯ï¼‰å¼çš„æå–ï¼ˆæˆ–/å’Œï¼‰å¼ï¼‰

5. å®Œå¤‡é›†ï¼šåˆå–(AND)ã€æå–(OR)ä¸å¦å®š(NOT)

   > å®é™…ä¸Šè¿™ä¸‰ç§é€»è¾‘å…³ç³»ä¸­ï¼Œä¸¤è€…å¯ä»¥è¡¨å‡ºç¬¬ä¸‰è€…ï¼Œå¦‚$A+B=\overline{\overline{A}~\overline{B}}$
   >
   > ï¼Œ$AB=\overline{\overline{A}+\overline{B}}$ã€‚è¿›è€Œå¯ä»¥å®šä¹‰ä¸éï¼ˆ$\uparrow$ï¼‰è¿ç®—ï¼š$A\uparrow B=\overline{A}+\overline{B}$ï¼ˆåˆå–å¼çš„å¦å®šï¼‰ï¼Œæˆ–éï¼ˆ$\downarrow$ï¼‰è¿ç®—ï¼š$A\downarrow B= \overline{A}~\overline{B}$ï¼ˆæå–å¼çš„å¦å®šï¼‰

6. åˆæƒ…æ¡ä»¶

   - åˆæƒ…ç¨‹åº¦ç”¨å®æ•°è¡¨ç¤º$(A|B)$
   - å®šæ€§åœ°ä¸å¸¸è¯†ç›¸ç¬¦
   - ä¸€è‡´æ€§æ¨ç†ï¼ˆç»“æœä¸è·¯å¾„æ— å…³ï¼‰

### chap 02 å®šé‡è§„åˆ™

1. ä¹˜æ³•è§„åˆ™

   $(AB|C)=F[(B|C), (A|BC)]$

   $(AB|C)=F[(A|C), (B|AC)]$

è¿›ä¸€æ­¥ç¡®å®š$F(x, y)$çš„å½¢å¼ï¼š

- ç”±åˆæƒ…æ¡ä»¶Iï¼š$F_x\geq 0, F_y\geq 0$

- ç”±è¿­ä»£å…³ç³»ï¼š$F[x, F(y, z)]=F[F(x, y),z]$

  è®°$u=F(x,y),v=F(y,z)$ï¼Œå¯¹ä¸Šé¢çš„è¡¨è¾¾å¼åˆ†åˆ«å¯¹$x,~y$æ±‚åå¯¼ï¼š
  $$
  F_1(u,z)F_1(x,y)=F_1(x,v)
  $$

  $$
  F_1(u,z)F_2(x,y)=F_2(x,v)F_1(y,z)
  $$

  è®°$G(x,y)=\frac{F_2(x,y)}{F_1(x,y)}$
  $$
  G(x,y)=G(x,v)F_1(y,z)......(\#)
  $$
  æˆ–
  $$
  G(x,y)G(y,z)=G(x,v)F_2(y,z)......(\#\#)
  $$
  å¯¹ï¼ˆ#ï¼‰å¼ï¼Œå¯¹æ±‚zåå¯¼ï¼š
  $$
  0=G_2(x,v)F_2(y,z)F_1(y,z)+G(x,v)F_{12}(y,z)
  $$
  å¯¹ï¼ˆ##ï¼‰å¼ï¼Œå¯¹yæ±‚åå¯¼ï¼š
  $$
  [G(x,y)G(y,z)]_y=G_2(x,v)F_1(y,z)F_2(y,z)+G(x,v)F_{21}(y,z)
  $$
  è¿ç»­æ€§ç»™å‡ºï¼š
  $$
  F_{12}(y,z)=F_{21}(y,z)
  $$
  ä»£å…¥å¾—åˆ°ï¼š
  $$
  [G(x,y)G(y,z)]_y=0
  $$
  è¿›è€Œå¯ä»¥ç¡®å®šå‡½æ•°$G(x,y)$çš„å½¢å¼ï¼š
  $$
  G(x,y)=r\frac{H(x)}{H(y)}
  $$
  å°†åˆ†ç¦»å˜é‡çš„å½¢å¼ä»£å…¥ï¼ˆ#ï¼‰ï¼ˆ##ï¼‰å¼ï¼Œç•¥å»æ¨å¯¼ï¼Œç§¯åˆ†å¾—åˆ°ï¼š
  $$
  \phi(v) = c\phi(y)\phi^r(z)
  $$
  å…¶ä¸­ï¼š
  $$
  \phi(x)=\int\frac{\mathrm{d}x}{H(x)}
  $$
  å°†è¿™ä¸€ç»“æœä»£å…¥è¿­ä»£å…³ç³»çš„è¡¨è¾¾å¼ï¼ŒåŒ–ç®€å¾—åˆ°ï¼š
  $$
  \phi(F(x,y))=c\cdot\phi(x)\phi(y)
  $$
  ä»¤$w(x)=c\cdot \phi(x)$ï¼Œå¾—åˆ°ï¼š
  $$
  w(F(x,y))=w(x)w(y)
  $$
  å›åˆ°åŸæ¥çš„é—®é¢˜ï¼Œå¾—åˆ°ç»“è®ºï¼š
  $$
  w(AB|C)=w(A|BC)w(B|C)
  $$

2. åŠ æ³•è§„åˆ™

   ç•¥å»æ¨å¯¼ï¼Œç”¨ç±»ä¼¼çš„æ–¹å¼å¯ä»¥æ¨å‡ºï¼š
   $$
   P(A|B)+P(\overline{A}|B)=1
   $$

3. æ¨ç†è§„åˆ™ä¸æ¼”ç»æ¨ç†ã€åˆæƒ…æ¨ç†ä¹‹é—´çš„å…³ç³»ï¼ˆåˆæƒ…æ¨ç†çš„åˆæƒ…ç¨‹åº¦ç”¨æ¦‚ç‡å‡½æ•°è¡¨è¾¾ï¼‰